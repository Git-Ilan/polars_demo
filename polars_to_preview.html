<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Intro 2 Polars</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="polars_to_preview_files/libs/clipboard/clipboard.min.js"></script>
<script src="polars_to_preview_files/libs/quarto-html/quarto.js"></script>
<script src="polars_to_preview_files/libs/quarto-html/popper.min.js"></script>
<script src="polars_to_preview_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="polars_to_preview_files/libs/quarto-html/anchor.min.js"></script>
<link href="polars_to_preview_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="polars_to_preview_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="polars_to_preview_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="polars_to_preview_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="polars_to_preview_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
        <script type="text/javascript">
        window.PlotlyConfig = {MathJaxConfig: 'local'};
        if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
        if (typeof require !== 'undefined') {
        require.undef("plotly");
        requirejs.config({
            paths: {
                'plotly': ['https://cdn.plot.ly/plotly-2.17.1.min']
            }
        });
        require(['plotly'], function(Plotly) {
            window._Plotly = Plotly;
        });
        }
        </script>
        

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Intro 2 Polars</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyarrow <span class="im">as</span> pa</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> string</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Following two lines only required to view plotly when rendering from VScode. </span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.io <span class="im">as</span> pio</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>pio.renderers.default <span class="op">=</span> <span class="st">"plotly_mimetype+notebook_connected"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="motivation" class="level1">
<h1>Motivation</h1>
<p>Each of the following, alone(!), is amazing.</p>
<ol type="1">
<li>Small memory footpring
<ul>
<li>Native dtypes: missing, strings.</li>
<li>Arrow format in memory.</li>
</ul></li>
<li>Lazy evaluation allows query Planning.</li>
<li>Out of the box parallelism: Fast and informative mesages for debugging.</li>
<li>Strict typing: This means the dtype of output is defined by the operation and not bu the input. This is both safers, and allows static analysis.</li>
</ol>
<section id="memory-footprint" class="level2">
<h2 class="anchored" data-anchor-id="memory-footprint">Memory Footprint</h2>
<section id="memory-footprint-of-storage" class="level3">
<h3 class="anchored" data-anchor-id="memory-footprint-of-storage">Memory Footprint of Storage</h3>
<p>Polars vs.&nbsp;Pandas:</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>letters <span class="op">=</span> pl.Series(<span class="bu">list</span>(string.ascii_letters))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">int</span>(<span class="fl">10e6</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>letter1 <span class="op">=</span> letters.sample(n,with_replacement<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>letter1.estimated_size(unit<span class="op">=</span><span class="st">'gb'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>0.08381903916597366</code></pre>
</div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>letter1_pandas <span class="op">=</span> letter1.to_pandas() </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>letter1_pandas.memory_usage(deep<span class="op">=</span><span class="va">True</span>, index<span class="op">=</span><span class="va">False</span>) <span class="op">/</span> <span class="fl">1e9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>0.58</code></pre>
</div>
</div>
<p>The memory footprint of the polars Series is 1/7 of the pandas Series(!). But I did cheat- I used string type data to emphasize the difference. The difference would have been smaller if I had used integers or floats.</p>
</section>
<section id="memory-footprint-of-compute" class="level3">
<h3 class="anchored" data-anchor-id="memory-footprint-of-compute">Memory Footprint of Compute</h3>
<p>You are probably storing your data to compute with it. Let’s compare the memory footprint of computations.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>load_ext memory_profiler</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>memit letter1.sort()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>peak memory: 546.39 MiB, increment: 216.77 MiB</code></pre>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>memit letter1_pandas.sort_values()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>peak memory: 672.14 MiB, increment: 341.86 MiB</code></pre>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>memit letter1[<span class="dv">10</span>]<span class="op">=</span><span class="st">'a'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>peak memory: 455.14 MiB, increment: 38.86 MiB</code></pre>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>memit letter1_pandas[<span class="dv">10</span>]<span class="op">=</span><span class="st">'a'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>peak memory: 417.30 MiB, increment: 0.00 MiB</code></pre>
</div>
</div>
<p>Things to notice:</p>
<ul>
<li>Operating on existing data consumes less memory in polars than in pandas.</li>
<li>Changing the data consumes more memory in polars than in pandas. Why is that?</li>
</ul>
</section>
<section id="operating-from-disk-to-disk" class="level3">
<h3 class="anchored" data-anchor-id="operating-from-disk-to-disk">Operating From Disk to Disk</h3>
<p>What if my data does not fit into RAM? Turns out you can read from disk, process in RAM, and write to disk. This allows you to process data larger than your memory.</p>
<p>TODO: demonstrate sink_parquet from <a href="https://www.rhosignal.com/posts/sink-parquet-files/">here</a>.</p>
</section>
</section>
<section id="query-planning" class="level2">
<h2 class="anchored" data-anchor-id="query-planning">Query Planning</h2>
<p>Consider a sort opperation that follows a filter operation. Ideally, filter precededs the sort, but we did not ensure this… We now demonstarte that polars’ query planner will do it for you. En passant, we see polars is more efficient also without the query planner.</p>
<p>Polars’ Eager evaluation, without query planning. Sort then filter.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n <span class="dv">2</span> <span class="op">-</span>r <span class="dv">2</span> letter1.sort().<span class="bu">filter</span>(letter1.is_in([<span class="st">'a'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>641 ms ± 3.73 ms per loop (mean ± std. dev. of 2 runs, 2 loops each)</code></pre>
</div>
</div>
<p>Polars’ Eager evaluation, without query planning. Filter then sort.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n <span class="dv">2</span> <span class="op">-</span>r <span class="dv">2</span> letter1.<span class="bu">filter</span>(letter1.is_in([<span class="st">'a'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>])).sort()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>201 ms ± 3.12 ms per loop (mean ± std. dev. of 2 runs, 2 loops each)</code></pre>
</div>
</div>
<p>Polars’ Lazy evaluation with query planning. Recieves sort then filter; executes filter then sort.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n <span class="dv">2</span> <span class="op">-</span>r <span class="dv">2</span> letter1.alias(<span class="st">'letters'</span>).to_frame().lazy().sort(by<span class="op">=</span><span class="st">'letters'</span>).<span class="bu">filter</span>(pl.col(<span class="st">'letters'</span>).is_in([<span class="st">'a'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>])).collect()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>174 ms ± 2.04 ms per loop (mean ± std. dev. of 2 runs, 2 loops each)</code></pre>
</div>
</div>
<p>Pandas’ eager evaluation in the wrong order: Sort then filter.</p>
<p>%timeit -n 2 -r 2 letter1_pandas.sort_values().loc[lambda x: x.isin([‘a’,‘b’,‘c’])]</p>
<pre><code>

Pandas eager evaluation in the right order: Filter then sort. 

::: {.cell execution_count=12}
``` {.python .cell-code}
%timeit -n 2 letter1_pandas.loc[lambda x: x.isin(['a','b','c'])].sort_values()</code></pre>
<div class="cell-output cell-output-stdout">
<pre><code>670 ms ± 7.66 ms per loop (mean ± std. dev. of 7 runs, 2 loops each)</code></pre>
</div>
<p>:::</p>
<p>Pandas alternative syntax, just as slow.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n <span class="dv">2</span> <span class="op">-</span>r <span class="dv">2</span> letter1_pandas.loc[letter1_pandas.isin([<span class="st">'a'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>])].sort_values()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>668 ms ± 393 µs per loop (mean ± std. dev. of 2 runs, 2 loops each)</code></pre>
</div>
</div>
<p>Things to note:</p>
<ol type="1">
<li>Query planning works!</li>
<li>Polars faster than Pandas even in eager evaluation (without query planning).</li>
</ol>
</section>
<section id="parallelism" class="level2">
<h2 class="anchored" data-anchor-id="parallelism">Parallelism</h2>
<p>Polars seamlessly parallelizes over columns (also within, when possible). As the number of columns in the data grows, we would expect fixed runtime until all cores are used, and then linear scaling. The following code demonstrates this idea, using a simple sum-within-column.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> scaling_of_sums(n_rows, n_cols):</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># n_cols = 2</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># n_rows = int(1e6)</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  A <span class="op">=</span> {}</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  A_numpy <span class="op">=</span> np.random.randn(n_rows,n_cols)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  A[<span class="st">'numpy'</span>] <span class="op">=</span> A_numpy.copy()</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  A[<span class="st">'polars'</span>] <span class="op">=</span> pl.DataFrame(A_numpy)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  A[<span class="st">'pandas'</span>] <span class="op">=</span> pd.DataFrame(A_numpy)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  times <span class="op">=</span> {}</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> key,value <span class="kw">in</span> A.items():</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    start <span class="op">=</span> time.time()</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    value.<span class="bu">sum</span>()</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    end <span class="op">=</span> time.time()</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    times[key] <span class="op">=</span> end<span class="op">-</span>start</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(times)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>scaling_of_time <span class="op">=</span> {</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  p:scaling_of_sums(n_rows<span class="op">=</span> <span class="bu">int</span>(<span class="fl">1e6</span>),n_cols <span class="op">=</span> p) <span class="cf">for</span> p <span class="kw">in</span> np.arange(<span class="dv">1</span>,<span class="dv">16</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame(scaling_of_time).T</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.line(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  data, </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  labels<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span><span class="st">"Number of Columns"</span>, </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    value<span class="op">=</span><span class="st">"Runtime"</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="806bdb84-4852-41ff-93be-63c4da8f5e61" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("806bdb84-4852-41ff-93be-63c4da8f5e61")) {                    Plotly.newPlot(                        "806bdb84-4852-41ff-93be-63c4da8f5e61",                        [{"hovertemplate":"variable=numpy<br>Number of Columns=%{x}<br>Runtime=%{y}<extra></extra>","legendgroup":"numpy","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"numpy","orientation":"v","showlegend":true,"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"xaxis":"x","y":[0.0005130767822265625,0.0018341541290283203,0.0012981891632080078,0.0020475387573242188,0.0024704933166503906,0.0031147003173828125,0.0038728713989257812,0.004382133483886719,0.005040645599365234,0.0062220096588134766,0.0064618587493896484,0.007110595703125,0.007518768310546875,0.008132457733154297,0.009538412094116211],"yaxis":"y","type":"scatter"},{"hovertemplate":"variable=polars<br>Number of Columns=%{x}<br>Runtime=%{y}<extra></extra>","legendgroup":"polars","line":{"color":"#EF553B","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"polars","orientation":"v","showlegend":true,"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"xaxis":"x","y":[0.0005357265472412109,0.0012798309326171875,0.0011467933654785156,0.0015904903411865234,0.001966238021850586,0.0019652843475341797,0.0022737979888916016,0.0029382705688476562,0.0031054019927978516,0.0034644603729248047,0.0037369728088378906,0.0048482418060302734,0.004189491271972656,0.00442957878112793,0.00583648681640625],"yaxis":"y","type":"scatter"},{"hovertemplate":"variable=pandas<br>Number of Columns=%{x}<br>Runtime=%{y}<extra></extra>","legendgroup":"pandas","line":{"color":"#00cc96","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"pandas","orientation":"v","showlegend":true,"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"xaxis":"x","y":[0.0021903514862060547,0.03654980659484863,0.03845858573913574,0.041509151458740234,0.04916834831237793,0.05206799507141113,0.058103322982788086,0.06548142433166504,0.06522893905639648,0.06894564628601074,0.0685586929321289,0.07474780082702637,0.07345080375671387,0.07242059707641602,0.07822251319885254],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Number of Columns"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Runtime"}},"legend":{"title":{"text":"variable"},"tracegroupgap":0},"margin":{"t":60}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('806bdb84-4852-41ff-93be-63c4da8f5e61');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>Things to note:</p>
<ul>
<li>Pandas is slow.</li>
<li>Numpy is quite efficient.</li>
<li>My machine has 8 cores. I would thus expect a fixed timing until 8 columns, and then linear scaling. This is not the case. I wonder why?</li>
</ul>
</section>
<section id="speed-of-import" class="level2">
<h2 class="anchored" data-anchor-id="speed-of-import">Speed Of Import</h2>
<p>Polar’s <code>read_x</code> functions are quite faster than Pandas. This is due to better type “guessing” heuristics, and to native support of the parquet file format.</p>
<p>We now make synthetic data, save it as csv or parquet, and reimport it with polars and pandas.</p>
<p>Starting with CSV:</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>n_rows <span class="op">=</span> <span class="bu">int</span>(<span class="fl">1e5</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>n_cols <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.random.randn(n_rows,n_cols)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>data.tofile(<span class="st">'data/data.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Import with pandas.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n2 <span class="op">-</span>r2 data_pandas <span class="op">=</span> pd.read_csv(<span class="st">'data/data.csv'</span>, header <span class="op">=</span> <span class="va">None</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>19.7 s ± 1.21 s per loop (mean ± std. dev. of 2 runs, 2 loops each)</code></pre>
</div>
</div>
<p>Import with polars.</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n2 <span class="op">-</span>r2 data_polars <span class="op">=</span> pl.read_csv(<span class="st">'data/data.csv'</span>, has_header <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3.48 s ± 398 ms per loop (mean ± std. dev. of 2 runs, 2 loops each)</code></pre>
</div>
</div>
<p>Moving to parquet:</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>data_pandas <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>data_pandas.columns <span class="op">=</span> data_pandas.columns.astype(<span class="bu">str</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>data_pandas.to_parquet(<span class="st">'data/data.parquet'</span>, index <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n2 <span class="op">-</span>r2 data_pandas <span class="op">=</span> pd.read_parquet(<span class="st">'data/data.parquet'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>25.2 ms ± 14.9 ms per loop (mean ± std. dev. of 2 runs, 2 loops each)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n2 <span class="op">-</span>r2 data_polars <span class="op">=</span> pl.read_parquet(<span class="st">'data/data.parquet'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>7.79 ms ± 940 µs per loop (mean ± std. dev. of 2 runs, 2 loops each)</code></pre>
</div>
</div>
<p>TODO: add feather.</p>
<p>Things to note:</p>
<ul>
<li>The difference in speed is quite large.</li>
<li>I dare argue that polars’ type guessing is better, but I am not demonstrating it here.</li>
<li>Bonus fact: parquet is much faster than csv, and also saves the frame’s schema.</li>
</ul>
</section>
<section id="speed-of-join" class="level2">
<h2 class="anchored" data-anchor-id="speed-of-join">Speed Of Join</h2>
<p>Because pandas is built on numpy, people see it as both an in-memory database, and a matrix/array library. With polars, it is quite clear it is an in-memory database, and not an array processing library (despite having a <code>pl.dot()</code> function for inner products). As such, you cannot multiply two polars dataframes, but you can certainly join then efficiently.</p>
<p>Make some data:</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_data(n_rows, n_cols):</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  data <span class="op">=</span> np.concatenate(</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  (</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    np.arange(n_rows)[:,np.newaxis], <span class="co"># index</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    np.random.randn(n_rows,n_cols), <span class="co"># values</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> data</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>n_rows <span class="op">=</span> <span class="bu">int</span>(<span class="fl">1e6</span>)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>n_cols <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>data_left <span class="op">=</span> make_data(n_rows, n_cols)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>data_right <span class="op">=</span> make_data(n_rows, n_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Polars join:</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>data_left_polars <span class="op">=</span> pl.DataFrame(data_left)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>data_right_polars <span class="op">=</span> pl.DataFrame(data_right)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n2 <span class="op">-</span>r2 polars_joined <span class="op">=</span> data_left_polars.join(data_right_polars, on <span class="op">=</span> <span class="st">'column_0'</span>, how <span class="op">=</span> <span class="st">'inner'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>206 ms ± 1.23 ms per loop (mean ± std. dev. of 2 runs, 2 loops each)</code></pre>
</div>
</div>
<p>Pandas join:</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>data_left_pandas <span class="op">=</span> pd.DataFrame(data_left)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>data_right_pandas <span class="op">=</span> pd.DataFrame(data_right)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n2 <span class="op">-</span>r2 pandas_joined <span class="op">=</span> data_left_pandas.merge(data_right_pandas, on <span class="op">=</span> <span class="dv">0</span>, how <span class="op">=</span> <span class="st">'inner'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>723 ms ± 70.6 ms per loop (mean ± std. dev. of 2 runs, 2 loops each)</code></pre>
</div>
</div>
</section>
<section id="moving-forward" class="level2">
<h2 class="anchored" data-anchor-id="moving-forward">Moving Forward…</h2>
<p>If this motivational seection has convinced you to try polars instead of pandas, here is a more structured intro.</p>
</section>
</section>
<section id="polars-series" class="level1">
<h1>Polars Series</h1>
<p>Much like pandas, polars’ fundamental building block is the series. A series is a column of data, with a name, and a dtype. In the following we:</p>
<ol type="1">
<li>Create a series and demonstrate basic operations on it.</li>
<li>Demonstrate the various dtypes.</li>
<li>Discuss missing values.</li>
<li>Filter a series.</li>
</ol>
<section id="series-housekeeping" class="level2">
<h2 class="anchored" data-anchor-id="series-housekeeping">Series Housekeeping</h2>
<p>Construct a series</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> pl.Series(<span class="st">"a"</span>, [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Make pandas series for comparison:</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>s_pandas <span class="op">=</span> pd.Series([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], name <span class="op">=</span> <span class="st">"a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>polars.internals.series.series.Series</code></pre>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(s_pandas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>pandas.core.series.Series</code></pre>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>s.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>Int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>s_pandas.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>dtype('int64')</code></pre>
</div>
</div>
<p>Renaming a series; will be very useful when operating on dataframe columns.</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>s.alias(<span class="st">"b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
b
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>s.clone()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>s.clone().append(pl.Series(<span class="st">"a"</span>, [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (6,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
<tr>
<td>
4
</td>
</tr>
<tr>
<td>
5
</td>
</tr>
<tr>
<td>
6
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Note: <code>series.append</code> operates in-place. That is why we cloned the series first.</p>
<p>Flatten a list of lists using <code>explode()</code>.</p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>pl.Series(<span class="st">"a"</span>, [[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>], [<span class="dv">9</span>, <span class="dv">10</span>]]).explode()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (6,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
<tr>
<td>
4
</td>
</tr>
<tr>
<td>
9
</td>
</tr>
<tr>
<td>
10
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>s.extend_constant(<span class="dv">666</span>, n<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (5,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
<tr>
<td>
666
</td>
</tr>
<tr>
<td>
666
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>s.new_from_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>s.rechunk()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>s.rename(<span class="st">"b"</span>, in_place<span class="op">=</span><span class="va">False</span>) <span class="co"># has an in_place option. Unlike .alias()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
b
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>s.to_dummies()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 3)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a_1
</th>
<th>
a_2
</th>
<th>
a_3
</th>
</tr>
<tr>
<td>
u8
</td>
<td>
u8
</td>
<td>
u8
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
</tr>
<tr>
<td>
0
</td>
<td>
1
</td>
<td>
0
</td>
</tr>
<tr>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>s.cleared() <span class="co"># creates an empty series, with same dtype</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (0,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
</div>
</div>
<p>Consturcting a series of floats, for later use.</p>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> pl.Series(<span class="st">"a"</span>, [<span class="fl">1.</span>, <span class="fl">2.</span>, <span class="fl">3.</span>])</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1.0
</td>
</tr>
<tr>
<td>
2.0
</td>
</tr>
<tr>
<td>
3.0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>f.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>Float64</code></pre>
</div>
</div>
</section>
<section id="memory-representation-of-series" class="level2">
<h2 class="anchored" data-anchor-id="memory-representation-of-series">Memory Representation of Series</h2>
<p>Object size in memory. Super useful for profiling:</p>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>s.estimated_size(unit<span class="op">=</span><span class="st">"gb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>2.2351741790771484e-08</code></pre>
</div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>s.chunk_lengths() <span class="co"># what is the length of each memory chunk?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>[3]</code></pre>
</div>
</div>
</section>
<section id="filtering-and-subsetting" class="level2">
<h2 class="anchored" data-anchor-id="filtering-and-subsetting">Filtering and Subsetting</h2>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>s[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>1</code></pre>
</div>
</div>
<p>Filtering with boolneas requires a series of booleans, not a list:</p>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>s.<span class="bu">filter</span>(pl.Series(<span class="st">"a"</span>, [<span class="va">True</span>, <span class="va">False</span>, <span class="va">True</span>])) <span class="co"># works</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Will not work:</p>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>s[[<span class="va">True</span>, <span class="va">False</span>, <span class="va">True</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NotImplementedError: Unsupported idxs datatype.</code></pre>
</div>
</div>
<p>Don’t be confused with pandas!</p>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>s.loc[[<span class="va">True</span>, <span class="va">False</span>, <span class="va">True</span>]] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>s.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>s.limit(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Negative indexing is not supported [TODO: verify]:</p>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>s.head(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>s.limit(<span class="op">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>s.tail(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>s.sample(<span class="dv">2</span>, with_replacement<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>s.take([<span class="dv">0</span>, <span class="dv">2</span>]) <span class="co"># same as .iloc</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>s.<span class="bu">slice</span>(<span class="dv">1</span>, <span class="dv">2</span>) <span class="co"># same as pandas .iloc[1:2]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>s.take_every(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="aggregations" class="level2">
<h2 class="anchored" data-anchor-id="aggregations">Aggregations</h2>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>s.<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>6</code></pre>
</div>
</div>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>s.<span class="bu">min</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>1</code></pre>
</div>
</div>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>s.arg_min()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>s.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>2.0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>s.median()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>2.0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>s.entropy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>-4.68213122712422</code></pre>
</div>
</div>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>s.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (6, 2)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
statistic
</th>
<th>
value
</th>
</tr>
<tr>
<td>
str
</td>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"min"
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"max"
</td>
<td>
3.0
</td>
</tr>
<tr>
<td>
"null_count"
</td>
<td>
0.0
</td>
</tr>
<tr>
<td>
"mean"
</td>
<td>
2.0
</td>
</tr>
<tr>
<td>
"std"
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"count"
</td>
<td>
3.0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>s.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 2)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
<th>
counts
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2
</td>
<td>
1
</td>
</tr>
<tr>
<td>
1
</td>
<td>
1
</td>
</tr>
<tr>
<td>
3
</td>
<td>
1
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="object-transformations" class="level2">
<h2 class="anchored" data-anchor-id="object-transformations">Object Transformations</h2>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>pl.Series(<span class="st">"a"</span>,[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>]).reshape(dims <span class="op">=</span> (<span class="dv">2</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
list[i64]
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
[1, 2]
</td>
</tr>
<tr>
<td>
[3, 4]
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>s.shift(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
null
</td>
</tr>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>s.shift(<span class="op">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
<tr>
<td>
null
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>s.shift_and_fill(<span class="dv">1</span>, <span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
999
</td>
</tr>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="mathematical-transformations" class="level2">
<h2 class="anchored" data-anchor-id="mathematical-transformations">Mathematical Transformations</h2>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>s.<span class="bu">abs</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>s.sin()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
0.841471
</td>
</tr>
<tr>
<td>
0.909297
</td>
</tr>
<tr>
<td>
0.14112
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>s.exp()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2.718282
</td>
</tr>
<tr>
<td>
7.389056
</td>
</tr>
<tr>
<td>
20.085537
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>s.<span class="bu">hash</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
u64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
13321499719149775801
</td>
</tr>
<tr>
<td>
8196255364589999986
</td>
</tr>
<tr>
<td>
3071011010030224171
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>s.log()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
0.0
</td>
</tr>
<tr>
<td>
0.693147
</td>
</tr>
<tr>
<td>
1.098612
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>s.peak_max()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
bool
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
false
</td>
</tr>
<tr>
<td>
false
</td>
</tr>
<tr>
<td>
true
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>s.sqrt()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1.0
</td>
</tr>
<tr>
<td>
1.414214
</td>
</tr>
<tr>
<td>
1.732051
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>s.clip_max(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>s.clip_min(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>You cannot round integers, but you can round floats.</p>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>f.<span class="bu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1.0
</td>
</tr>
<tr>
<td>
2.0
</td>
</tr>
<tr>
<td>
3.0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>f.ceil()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1.0
</td>
</tr>
<tr>
<td>
2.0
</td>
</tr>
<tr>
<td>
3.0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>f.floor()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1.0
</td>
</tr>
<tr>
<td>
2.0
</td>
</tr>
<tr>
<td>
3.0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>s.is_in(pl.Series([<span class="dv">1</span>, <span class="dv">10</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
bool
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
true
</td>
</tr>
<tr>
<td>
false
</td>
</tr>
<tr>
<td>
false
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><strong>Caution</strong>: <code>is_in()</code> in polars has an underscore, unlike <code>isin()</code> in pandas.</p>
</section>
<section id="apply" class="level2">
<h2 class="anchored" data-anchor-id="apply">Apply</h2>
<p>Applying your own function:</p>
<div class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>s.<span class="bu">apply</span>(<span class="kw">lambda</span> x: x <span class="op">+</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="80">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
<tr>
<td>
4
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Using your own functions comes with a performance cost:</p>
<div class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>s1 <span class="op">=</span> pl.Series(np.random.randn(<span class="bu">int</span>(<span class="fl">1e5</span>)))</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n2 <span class="op">-</span>r2 s1<span class="op">+</span><span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.39 ms ± 251 µs per loop (mean ± std. dev. of 2 runs, 2 loops each)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n2 <span class="op">-</span>r2 s1.<span class="bu">apply</span>(<span class="kw">lambda</span> x: x <span class="op">+</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>20.6 ms ± 14.5 µs per loop (mean ± std. dev. of 2 runs, 2 loops each)</code></pre>
</div>
</div>
</section>
<section id="cummulative-operations" class="level2">
<h2 class="anchored" data-anchor-id="cummulative-operations">Cummulative Operations</h2>
<div class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>s.cummax()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="83">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>s.cumsum()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
<tr>
<td>
6
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>s.cumprod()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="85">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
6
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>s.ewm_mean(com<span class="op">=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1.0
</td>
</tr>
<tr>
<td>
1.75
</td>
</tr>
<tr>
<td>
2.615385
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="sequential-operations" class="level2">
<h2 class="anchored" data-anchor-id="sequential-operations">Sequential Operations</h2>
<div class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>s.diff()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="87">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
null
</td>
</tr>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
1
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>s.pct_change()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="88">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
null
</td>
</tr>
<tr>
<td>
1.0
</td>
</tr>
<tr>
<td>
0.5
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="windowed-operations" class="level2">
<h2 class="anchored" data-anchor-id="windowed-operations">Windowed Operations</h2>
<div class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>s.rolling_apply(</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  pl.<span class="bu">sum</span>, </span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  window_size<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
null
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
<tr>
<td>
5
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Not all functions will work within a <code>rolling_apply</code>! Only polars’ functions will.</p>
<div class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>s.rolling_apply(np.<span class="bu">sum</span>, window_size<span class="op">=</span><span class="dv">2</span>) <span class="co"># will not work</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>s.rolling_max(window_size<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="90">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
null
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>s.clip(<span class="dv">1</span>, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="91">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>s.clone()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="92">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check equality with clone</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>s <span class="op">==</span> s.clone()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="93">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
bool
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
true
</td>
</tr>
<tr>
<td>
true
</td>
</tr>
<tr>
<td>
true
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="booleans" class="level2">
<h2 class="anchored" data-anchor-id="booleans">Booleans</h2>
<div class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> pl.Series(<span class="st">"a"</span>, [<span class="va">True</span>, <span class="va">True</span>, <span class="va">False</span>])</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>b.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="94">
<pre><code>Boolean</code></pre>
</div>
</div>
<div class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>b.<span class="bu">all</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="95">
<pre><code>False</code></pre>
</div>
</div>
<div class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>b.<span class="bu">any</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="96">
<pre><code>True</code></pre>
</div>
</div>
</section>
<section id="uniques-and-duplicates" class="level2">
<h2 class="anchored" data-anchor-id="uniques-and-duplicates">Uniques and Duplicates</h2>
<div class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>s.is_duplicated()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="97">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
bool
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
false
</td>
</tr>
<tr>
<td>
false
</td>
</tr>
<tr>
<td>
false
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>s.is_unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="98">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
bool
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
true
</td>
</tr>
<tr>
<td>
true
</td>
</tr>
<tr>
<td>
true
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>s.n_unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="99">
<pre><code>3</code></pre>
</div>
</div>
<div class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>pl.Series([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>]).unique_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="100">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (4,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
1
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The first appearance of a value in a series:</p>
<div class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>pl.Series([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>]).is_first()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="101">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (5,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
bool
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
true
</td>
</tr>
<tr>
<td>
true
</td>
</tr>
<tr>
<td>
true
</td>
</tr>
<tr>
<td>
true
</td>
</tr>
<tr>
<td>
false
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="dtypes" class="level2">
<h2 class="anchored" data-anchor-id="dtypes">dtypes</h2>
<p><strong>Note</strong>. Unlike pandas, polars’ test functions have an underscore: <code>is_numeric()</code> instead of <code>isnumeric()</code>.</p>
<section id="testing" class="level3">
<h3 class="anchored" data-anchor-id="testing">Testing</h3>
<div class="cell" data-execution_count="106">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>s.is_numeric()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="102">
<pre><code>True</code></pre>
</div>
</div>
<div class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>s.is_float()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="103">
<pre><code>False</code></pre>
</div>
</div>
<div class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>s.is_utf8()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="104">
<pre><code>False</code></pre>
</div>
</div>
<div class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>s.is_boolean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="105">
<pre><code>False</code></pre>
</div>
</div>
<div class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>s.is_datelike()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="106">
<pre><code>False</code></pre>
</div>
</div>
<p>Compare with Pandas Type Checkers:</p>
<div class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>pd.api.types.is_string_dtype(s_pandas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="107">
<pre><code>False</code></pre>
</div>
</div>
<div class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>pd.api.types.is_string_dtype(s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="108">
<pre><code>False</code></pre>
</div>
</div>
</section>
<section id="casting" class="level3">
<h3 class="anchored" data-anchor-id="casting">Casting</h3>
<div class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>s.cast(pl.Int32)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="109">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Things to note:</p>
<ul>
<li><code>s.cast()</code> is an in place operation. If you want to keep the original series, you can use <code>s.cast(pl.Int32).clone()</code>.</li>
<li><code>cast()</code> is polars’ equivalent of pandas’ <code>astype()</code>.</li>
<li>For a list of dtypes see the official <a href="see%20https://pola-rs.github.io/polars/py-polars/html/reference/datatypes.html">documentation</a>.</li>
</ul>
</section>
<section id="optimizing-dtypes" class="level3">
<h3 class="anchored" data-anchor-id="optimizing-dtypes">Optimizing dtypes</h3>
<p>Find the most efficient dtype for a series:</p>
<div class="cell" data-execution_count="114">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>s.shrink_dtype()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="110">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i8
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Also see <a href="http://braaannigan.github.io/software/2022/10/31/polars-dtype-diet.html">here</a>.</p>
<p>Shrink the memory allocation to the size of the actual data (in place).</p>
<div class="cell" data-execution_count="115">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>s.shrink_to_fit() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="111">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="ordering-and-sorting" class="level2">
<h2 class="anchored" data-anchor-id="ordering-and-sorting">Ordering and Sorting</h2>
<div class="cell" data-execution_count="116">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>s.sort()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="112">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="117">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>s.reverse()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="113">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
3
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
1
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="118">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>s.rank()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="114">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
f32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1.0
</td>
</tr>
<tr>
<td>
2.0
</td>
</tr>
<tr>
<td>
3.0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="119">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>s.arg_sort() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="115">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
</tr>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><code>arg_sort()</code> returns the indices that would sort the series. Same as R’s <code>order()</code>.</p>
<div class="cell" data-execution_count="120">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>s.sort() <span class="op">==</span> s[s.arg_sort()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="116">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
bool
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
true
</td>
</tr>
<tr>
<td>
true
</td>
</tr>
<tr>
<td>
true
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><code>arg_sort()</code> can also be used to return the original series from the sorted one:</p>
<div class="cell" data-execution_count="121">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">==</span> s[s[s.arg_sort()].arg_sort()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="117">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
bool
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
true
</td>
</tr>
<tr>
<td>
true
</td>
</tr>
<tr>
<td>
true
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="122">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>s.shuffle(seed<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="118">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="missing" class="level2">
<h2 class="anchored" data-anchor-id="missing">Missing</h2>
<p>Pandas users will be excited to know that polars has built in missing value support (!) for all dtypes. This has been a long awaited feature in the Python data science ecosystem, with implications on performance and syntax.</p>
<div class="cell" data-execution_count="123">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> pl.Series(<span class="st">"a"</span>, [<span class="dv">1</span>, <span class="dv">2</span>, <span class="va">None</span>, np.nan])</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>m.is_null()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="119">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (4,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
bool
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
false
</td>
</tr>
<tr>
<td>
false
</td>
</tr>
<tr>
<td>
true
</td>
</tr>
<tr>
<td>
false
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="124">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>m.is_nan()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="120">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (4,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
bool
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
false
</td>
</tr>
<tr>
<td>
false
</td>
</tr>
<tr>
<td>
null
</td>
</tr>
<tr>
<td>
true
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="125">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="op">=</span> pl.Series(<span class="st">"a"</span>, [<span class="dv">1</span>, <span class="va">None</span>, <span class="dv">2</span>, ]) <span class="co"># python native None</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="op">=</span> pl.Series(<span class="st">"a"</span>, [<span class="dv">1</span>, np.nan, <span class="dv">2</span>, ]) <span class="co"># numpy's nan</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>m3 <span class="op">=</span> pl.Series(<span class="st">"a"</span>, [<span class="dv">1</span>, <span class="bu">float</span>(<span class="st">'nan'</span>), <span class="dv">2</span>, ]) <span class="co"># python's nan</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>m4 <span class="op">=</span> pd.Series([<span class="dv">1</span>, <span class="va">None</span>, <span class="dv">2</span> ])</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>m5 <span class="op">=</span> pd.Series([<span class="dv">1</span>, np.nan, <span class="dv">2</span>, ])</span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>m6 <span class="op">=</span> pd.Series([<span class="dv">1</span>, <span class="bu">float</span>(<span class="st">'nan'</span>), <span class="dv">2</span>, ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="126">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>[m1.<span class="bu">sum</span>(), m2.<span class="bu">sum</span>(), m3.<span class="bu">sum</span>(), m4.<span class="bu">sum</span>(), m5.<span class="bu">sum</span>(), m6.<span class="bu">sum</span>()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="122">
<pre><code>[3, nan, nan, 3.0, 3.0, 3.0]</code></pre>
</div>
</div>
<p>Things to note:</p>
<ul>
<li>The use of <code>is_null()</code> instead of pandas <code>isna()</code>.</li>
<li>Polars supports <code>np.nan</code> but that is a different dtype than <code>None</code> (which is a <code>Null</code> type). <code>None</code> is not considered</li>
<li>Aggregating pandas and polars series behave differently w.r.t. missing values:
<ul>
<li>Both will ignore <code>None</code>; which is unsafe.</li>
<li>Polars will not ignore <code>np.nan</code>; which is safe. Pandas is unsafe w.r.t. <code>np.nan</code>, and will ignore it.</li>
</ul></li>
</ul>
<p>Filling missing values; <code>None</code> and <code>np.nan</code> are treated differently:</p>
<div class="cell" data-execution_count="127">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>m1.fill_null(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="123">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
0
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="128">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>m1.interpolate()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="124">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="129">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>m2.fill_null(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="125">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1.0
</td>
</tr>
<tr>
<td>
NaN
</td>
</tr>
<tr>
<td>
2.0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="130">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>m2.fill_nan(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="126">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1.0
</td>
</tr>
<tr>
<td>
0.0
</td>
</tr>
<tr>
<td>
2.0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="131">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>m1.drop_nulls()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="127">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="132">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>m1.drop_nans()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="128">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
null
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="133">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>m2.drop_nulls()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="129">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1.0
</td>
</tr>
<tr>
<td>
NaN
</td>
</tr>
<tr>
<td>
2.0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="export" class="level2">
<h2 class="anchored" data-anchor-id="export">Export</h2>
<div class="cell" data-execution_count="134">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>s.to_frame()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="130">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 1)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="135">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>s.to_list()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="131">
<pre><code>[1, 2, 3]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="136">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>s.to_numpy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="132">
<pre><code>array([1, 2, 3])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="137">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>s.to_pandas()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="133">
<pre><code>0    1
1    2
2    3
Name: a, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="138">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>s.to_arrow()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="134">
<pre><code>&lt;pyarrow.lib.Int64Array object at 0x7fb67befc3a0&gt;
[
  1,
  2,
  3
]</code></pre>
</div>
</div>
</section>
<section id="strings" class="level2">
<h2 class="anchored" data-anchor-id="strings">Strings</h2>
<p>Like Pandas, accessed with the <code>.str</code> attribute.</p>
<div class="cell" data-execution_count="139">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>st <span class="op">=</span> pl.Series(<span class="st">"a"</span>, [<span class="st">"foo"</span>, <span class="st">"bar"</span>, <span class="st">"baz"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="140">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>st.<span class="bu">str</span>.n_chars() <span class="co"># gets number of chars. In ASCII this is the same as lengths()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="136">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
3
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="141">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>st.<span class="bu">str</span>.lengths() <span class="co"># gets number of bytes in memory</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="137">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
3
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="142">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>st.<span class="bu">str</span>.concat(<span class="st">"-"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="138">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (1,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"foo-bar-baz"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="143">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>st.<span class="bu">str</span>.contains(<span class="st">"foo|tra|bar"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="139">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
bool
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
true
</td>
</tr>
<tr>
<td>
true
</td>
</tr>
<tr>
<td>
false
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="144">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>st.<span class="bu">str</span>.count_match(pattern<span class="op">=</span> <span class="st">'o'</span>) <span class="co"># count literal metches</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="140">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
0
</td>
</tr>
<tr>
<td>
0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Count pattern matches. Notice the <code>r"&lt;regex pattern&gt;"</code> syntax for regex (more about it <a href="https://stackoverflow.com/questions/2241600/python-regex-r-prefix">here</a>).</p>
<div class="cell" data-execution_count="145">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>st.<span class="bu">str</span>.count_match(<span class="vs">r"\w"</span>) <span class="co"># regex for alphanumeric</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="141">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
3
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="146">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>st.<span class="bu">str</span>.ends_with(<span class="st">"oo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="142">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
bool
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
true
</td>
</tr>
<tr>
<td>
false
</td>
</tr>
<tr>
<td>
false
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="147">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>st.<span class="bu">str</span>.starts_with(<span class="st">"fo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="143">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
bool
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
true
</td>
</tr>
<tr>
<td>
false
</td>
</tr>
<tr>
<td>
false
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>To extract the first appearance of a pattern, use <code>extract</code>:</p>
<div class="cell" data-execution_count="148">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> pl.Series(<span class="st">"a"</span>, [</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">"http://vote.com/ballon_dor?candidate=messi&amp;ref=polars"</span>,</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">"http://vote.com/ballon_dor?candidate=jorginho&amp;ref=polars"</span>,</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">"http://vote.com/ballon_dor?candidate=ronaldo&amp;ref=polars"</span></span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>            ])</span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a>url.<span class="bu">str</span>.extract(<span class="vs">r"=(\w+)"</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="144">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"messi"
</td>
</tr>
<tr>
<td>
"jorginho"
</td>
</tr>
<tr>
<td>
"ronaldo"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>To extract all appearances of a pattern, use <code>extract_all</code>:</p>
<div class="cell" data-execution_count="149">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>url.<span class="bu">str</span>.extract_all(<span class="st">"=(\w+)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="145">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
list[str]
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
["=messi", "=polars"]
</td>
</tr>
<tr>
<td>
["=jorginho", "=polars"]
</td>
</tr>
<tr>
<td>
["=ronaldo", "=polars"]
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="150">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>st.<span class="bu">str</span>.ljust(<span class="dv">8</span>, <span class="st">"*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="146">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"foo*****"
</td>
</tr>
<tr>
<td>
"bar*****"
</td>
</tr>
<tr>
<td>
"baz*****"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="151">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>st.<span class="bu">str</span>.rjust(<span class="dv">8</span>, <span class="st">"*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="147">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"*****foo"
</td>
</tr>
<tr>
<td>
"*****bar"
</td>
</tr>
<tr>
<td>
"*****baz"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="152">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>st.<span class="bu">str</span>.lstrip(<span class="st">'f'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="148">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"oo"
</td>
</tr>
<tr>
<td>
"bar"
</td>
</tr>
<tr>
<td>
"baz"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="153">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>st.<span class="bu">str</span>.rstrip(<span class="st">'r'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="149">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"foo"
</td>
</tr>
<tr>
<td>
"ba"
</td>
</tr>
<tr>
<td>
"baz"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Replacing first appearance of a pattern:</p>
<div class="cell" data-execution_count="154">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>st.<span class="bu">str</span>.replace(<span class="vs">r"o"</span>, <span class="st">"ZZ"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="150">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"fZZo"
</td>
</tr>
<tr>
<td>
"bar"
</td>
</tr>
<tr>
<td>
"baz"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="155">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>st.<span class="bu">str</span>.replace(<span class="vs">r"o+"</span>, <span class="st">"ZZ"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="151">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"fZZ"
</td>
</tr>
<tr>
<td>
"bar"
</td>
</tr>
<tr>
<td>
"baz"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Replace all appearances of a pattern:</p>
<div class="cell" data-execution_count="156">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>st.<span class="bu">str</span>.replace_all(<span class="st">"o"</span>, <span class="st">"ZZ"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="152">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"fZZZZ"
</td>
</tr>
<tr>
<td>
"bar"
</td>
</tr>
<tr>
<td>
"baz"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>String to list of strings. Number of spits inferred.</p>
<div class="cell" data-execution_count="157">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>st.<span class="bu">str</span>.split(by<span class="op">=</span><span class="st">"o"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="153">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
list[str]
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
["f", "", ""]
</td>
</tr>
<tr>
<td>
["bar"]
</td>
</tr>
<tr>
<td>
["baz"]
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="158">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>st.<span class="bu">str</span>.split(by<span class="op">=</span><span class="st">"a"</span>, inclusive<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="154">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
list[str]
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
["foo"]
</td>
</tr>
<tr>
<td>
["ba", "r"]
</td>
</tr>
<tr>
<td>
["ba", "z"]
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>String to dict of strings. Number of splits fixed.</p>
<div class="cell" data-execution_count="159">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>st.<span class="bu">str</span>.split_exact(<span class="st">"a"</span>, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="155">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
struct[3]
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
{"foo",null,null}
</td>
</tr>
<tr>
<td>
{"b","r",null}
</td>
</tr>
<tr>
<td>
{"b","z",null}
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>String to dict of strings. Length of output fixed.</p>
<div class="cell" data-execution_count="160">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>st.<span class="bu">str</span>.splitn(<span class="st">"a"</span>, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="156">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
struct[4]
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
{"foo",null,null,null}
</td>
</tr>
<tr>
<td>
{"b","r",null,null}
</td>
</tr>
<tr>
<td>
{"b","z",null,null}
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Strip white spaces.</p>
<div class="cell" data-execution_count="161">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>st.<span class="bu">str</span>.rjust(<span class="dv">8</span>, <span class="st">" "</span>).<span class="bu">str</span>.strip()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="157">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"foo"
</td>
</tr>
<tr>
<td>
"bar"
</td>
</tr>
<tr>
<td>
"baz"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="162">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>st.<span class="bu">str</span>.to_uppercase()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="158">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"FOO"
</td>
</tr>
<tr>
<td>
"BAR"
</td>
</tr>
<tr>
<td>
"BAZ"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="163">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>st.<span class="bu">str</span>.to_lowercase()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="159">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"foo"
</td>
</tr>
<tr>
<td>
"bar"
</td>
</tr>
<tr>
<td>
"baz"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="164">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>st.<span class="bu">str</span>.zfill(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="160">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
a
</th>
</tr>
<tr>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"00foo"
</td>
</tr>
<tr>
<td>
"00bar"
</td>
</tr>
<tr>
<td>
"00baz"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="date-and-time" class="level2">
<h2 class="anchored" data-anchor-id="date-and-time">Date and Time</h2>
<p>There are 4 datetime dtypes in polars:</p>
<ol type="1">
<li>Date: A date, without hours. Generated with <code>pl.Date()</code>.</li>
<li>Datetime: Date and hours. Generated with <code>pl.Datetime()</code>.</li>
<li>Duration: As the name suggests. Similar t o <code>timedelta</code> in pandas. Generated with <code>pl.Duration()</code>.</li>
<li>Time: Hour of day. Generated with <code>pl.Time()</code>.</li>
</ol>
<section id="converting-from-strings" class="level3">
<h3 class="anchored" data-anchor-id="converting-from-strings">Converting from Strings</h3>
<div class="cell" data-execution_count="165">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>sd <span class="op">=</span> pl.Series(</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"date"</span>,</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2021-04-22"</span>,</span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2022-01-04 00:00:00"</span>,</span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"01/31/22"</span>,</span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Sun Jul  8 00:34:60 2001"</span>,</span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a>sd.<span class="bu">str</span>.strptime(pl.Date, <span class="st">"</span><span class="sc">%F</span><span class="st">"</span>, strict<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="161">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (4,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
date
</th>
</tr>
<tr>
<td>
date
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2021-04-22
</td>
</tr>
<tr>
<td>
null
</td>
</tr>
<tr>
<td>
null
</td>
</tr>
<tr>
<td>
null
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="166">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>sd.<span class="bu">str</span>.strptime(pl.Date, <span class="st">"</span><span class="sc">%F</span><span class="st"> %T"</span>,strict<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="162">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (4,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
date
</th>
</tr>
<tr>
<td>
date
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
null
</td>
</tr>
<tr>
<td>
2022-01-04
</td>
</tr>
<tr>
<td>
null
</td>
</tr>
<tr>
<td>
null
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="167">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>sd.<span class="bu">str</span>.strptime(pl.Date, <span class="st">"%D"</span>, strict<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="163">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (4,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
date
</th>
</tr>
<tr>
<td>
date
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
null
</td>
</tr>
<tr>
<td>
null
</td>
</tr>
<tr>
<td>
2022-01-31
</td>
</tr>
<tr>
<td>
null
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="time-range" class="level3">
<h3 class="anchored" data-anchor-id="time-range">Time Range</h3>
<div class="cell" data-execution_count="168">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timedelta</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> datetime(year<span class="op">=</span> <span class="dv">2001</span>, month<span class="op">=</span><span class="dv">2</span>, day<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>stop <span class="op">=</span> datetime(year<span class="op">=</span><span class="dv">2001</span>, month<span class="op">=</span><span class="dv">2</span>, day<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a>date <span class="op">=</span> pl.date_range(</span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a>  low<span class="op">=</span>start, </span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a>  high<span class="op">=</span>stop, </span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a>  interval<span class="op">=</span>timedelta(seconds<span class="op">=</span><span class="dv">500</span><span class="op">*</span><span class="dv">61</span>))</span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true" tabindex="-1"></a>date</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="164">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
datetime[μs]
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2001-02-02 00:00:00
</td>
</tr>
<tr>
<td>
2001-02-02 08:28:20
</td>
</tr>
<tr>
<td>
2001-02-02 16:56:40
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Things to note:</p>
<ul>
<li>How else could I have constructed this series? What other types are accepted as <code>low</code> and <code>high</code>?</li>
<li><code>pl.date_range</code> may return a series of dtype <code>Date</code> or <code>Datetime</code>. This depens of the granularity of the inputs.</li>
</ul>
<div class="cell" data-execution_count="169">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>date.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="165">
<pre><code>Datetime(tu='us', tz=None)</code></pre>
</div>
</div>
<p>Cast to different time unit. May be useful when joining datasets, and the time unit is different.</p>
<div class="cell" data-execution_count="170">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>date.dt.cast_time_unit(tu<span class="op">=</span><span class="st">"ms"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="166">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
datetime[ms]
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2001-02-02 00:00:00
</td>
</tr>
<tr>
<td>
2001-02-02 08:28:20
</td>
</tr>
<tr>
<td>
2001-02-02 16:56:40
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="from-date-to-string" class="level3">
<h3 class="anchored" data-anchor-id="from-date-to-string">From Date to String</h3>
<div class="cell" data-execution_count="171">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>date.dt.strftime(<span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="167">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"2001-02-02"
</td>
</tr>
<tr>
<td>
"2001-02-02"
</td>
</tr>
<tr>
<td>
"2001-02-02"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="ecxtract-time-sub-units" class="level3">
<h3 class="anchored" data-anchor-id="ecxtract-time-sub-units">Ecxtract Time Sub-Units</h3>
<div class="cell" data-execution_count="172">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>date.dt.second()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="168">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
</tr>
<tr>
<td>
20
</td>
</tr>
<tr>
<td>
40
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="173">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>date.dt.minute()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="169">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
</tr>
<tr>
<td>
28
</td>
</tr>
<tr>
<td>
56
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="174">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>date.dt.hour()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="170">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
</tr>
<tr>
<td>
8
</td>
</tr>
<tr>
<td>
16
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="175">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>date.dt.day()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="171">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="176">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>date.dt.week()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="172">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
5
</td>
</tr>
<tr>
<td>
5
</td>
</tr>
<tr>
<td>
5
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="177">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>date.dt.weekday()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="173">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
5
</td>
</tr>
<tr>
<td>
5
</td>
</tr>
<tr>
<td>
5
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="178">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>date.dt.month()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="174">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="179">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>date.dt.year()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="175">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
i32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2001
</td>
</tr>
<tr>
<td>
2001
</td>
</tr>
<tr>
<td>
2001
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="180">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>date.dt.ordinal_day() <span class="co"># day in year</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="176">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
33
</td>
</tr>
<tr>
<td>
33
</td>
</tr>
<tr>
<td>
33
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="181">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>date.dt.quarter()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="177">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
1
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="durations" class="level3">
<h3 class="anchored" data-anchor-id="durations">Durations</h3>
<p>Equivalent to Pandas <code>period</code> dtype.</p>
<div class="cell" data-execution_count="182">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>diffs <span class="op">=</span> date.diff()</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>diffs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="178">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
duration[μs]
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
null
</td>
</tr>
<tr>
<td>
8h 28m 20s
</td>
</tr>
<tr>
<td>
8h 28m 20s
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="183">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>diffs.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="179">
<pre><code>Duration(tu='us')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="184">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>diffs.dt.seconds()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="180">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
null
</td>
</tr>
<tr>
<td>
30500
</td>
</tr>
<tr>
<td>
30500
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="185">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>diffs.dt.minutes()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="181">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
null
</td>
</tr>
<tr>
<td>
508
</td>
</tr>
<tr>
<td>
508
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="186">
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>diffs.dt.days()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="182">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
null
</td>
</tr>
<tr>
<td>
0
</td>
</tr>
<tr>
<td>
0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="187">
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>diffs.dt.hours()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="183">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
null
</td>
</tr>
<tr>
<td>
8
</td>
</tr>
<tr>
<td>
8
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="date-aggregations" class="level3">
<h3 class="anchored" data-anchor-id="date-aggregations">Date Aggregations</h3>
<p>Note that aggregating dates, returns a <code>datetime</code> type object.</p>
<div class="cell" data-execution_count="188">
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>date.dt.<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="184">
<pre><code>datetime.datetime(2001, 2, 2, 16, 56, 40)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="189">
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>date.dt.<span class="bu">min</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="185">
<pre><code>datetime.datetime(2001, 2, 2, 0, 0)</code></pre>
</div>
</div>
<p>I have no idea what is an “average date”, but it can be computed.</p>
<div class="cell" data-execution_count="190">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>date.dt.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="186">
<pre><code>datetime.datetime(2001, 2, 2, 8, 28, 20)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="191">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>date.dt.median()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="187">
<pre><code>datetime.datetime(2001, 2, 2, 8, 28, 20)</code></pre>
</div>
</div>
</section>
<section id="data-transformations" class="level3">
<h3 class="anchored" data-anchor-id="data-transformations">Data Transformations</h3>
<p>Notice the syntax of <code>offset_by</code>. It is similar to R’s <code>lubridate</code> package.</p>
<div class="cell" data-execution_count="192">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>date.dt.offset_by(by<span class="op">=</span><span class="st">"1y2m20d"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="188">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
datetime[μs]
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2002-02-22 00:02:00
</td>
</tr>
<tr>
<td>
2002-02-22 08:30:20
</td>
</tr>
<tr>
<td>
2002-02-22 16:58:40
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Nagative offset is also allowed.</p>
<div class="cell" data-execution_count="193">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a>date.dt.offset_by(by<span class="op">=</span><span class="st">"-1y2m20d"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="189">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
datetime[μs]
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2000-01-12 23:58:00
</td>
</tr>
<tr>
<td>
2000-01-13 08:26:20
</td>
</tr>
<tr>
<td>
2000-01-13 16:54:40
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="194">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a>date.dt.<span class="bu">round</span>(<span class="st">"1y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="190">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
datetime[μs]
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2001-01-01 00:00:00
</td>
</tr>
<tr>
<td>
2001-01-01 00:00:00
</td>
</tr>
<tr>
<td>
2001-01-01 00:00:00
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="195">
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>date2 <span class="op">=</span> date.dt.truncate(<span class="st">"30m"</span>) <span class="co"># round to period</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>pd.crosstab(date,date2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="191">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>col_0</th>
      <th>2001-02-02 00:00:00</th>
      <th>2001-02-02 08:00:00</th>
      <th>2001-02-02 16:30:00</th>
    </tr>
    <tr>
      <th>row_0</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2001-02-02 00:00:00</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2001-02-02 08:28:20</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2001-02-02 16:56:40</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="comparing-series" class="level2">
<h2 class="anchored" data-anchor-id="comparing-series">Comparing Series</h2>
<div class="cell" data-execution_count="196">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>s.series_equal(pl.Series(<span class="st">"a"</span>, [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="192">
<pre><code>True</code></pre>
</div>
</div>
</section>
</section>
<section id="dataframes" class="level1">
<h1>DataFrames</h1>
<p>General:</p>
<ol type="1">
<li>There is no row index (like R’s <code>data.frame</code>, <code>data.table</code>, and <code>tibble</code>; unlike Python’s <code>pandas</code>).</li>
<li>Will not accept duplicat column names (unlike pandas).</li>
</ol>
<section id="dataframe-object-hosekeeping" class="level2">
<h2 class="anchored" data-anchor-id="dataframe-object-hosekeeping">DataFrame-Object Hosekeeping</h2>
<p>A frame can be created as you would expect. From a dictionary of series, a numpy array, a pandas sdataframe, or a list of polars (or pandas) series, etc.</p>
<div class="cell" data-execution_count="197">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pl.DataFrame({</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"integer"</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], </span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"date"</span>: [</span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>    (datetime(<span class="dv">2022</span>, <span class="dv">1</span>, <span class="dv">1</span>)), </span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>    (datetime(<span class="dv">2022</span>, <span class="dv">1</span>, <span class="dv">2</span>)), </span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a>    (datetime(<span class="dv">2022</span>, <span class="dv">1</span>, <span class="dv">3</span>))], </span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"float"</span>:[<span class="fl">4.0</span>, <span class="fl">5.0</span>, <span class="fl">6.0</span>],</span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"string"</span>: [<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>]})</span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-10"><a href="#cb254-10" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="193">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="198">
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 4)
┌─────────┬─────────────────────┬───────┬────────┐
│ integer ┆ date                ┆ float ┆ string │
│ ---     ┆ ---                 ┆ ---   ┆ ---    │
│ i64     ┆ datetime[μs]        ┆ f64   ┆ str    │
╞═════════╪═════════════════════╪═══════╪════════╡
│ 1       ┆ 2022-01-01 00:00:00 ┆ 4.0   ┆ a      │
│ 2       ┆ 2022-01-02 00:00:00 ┆ 5.0   ┆ b      │
│ 3       ┆ 2022-01-03 00:00:00 ┆ 6.0   ┆ c      │
└─────────┴─────────────────────┴───────┴────────┘</code></pre>
</div>
</div>
<p>Things to note:</p>
<ol type="1">
<li>The frame may be printed with Jupter’s styling, or as ASCII with a <code>print()</code> statement.</li>
<li>Shape, and dtypes, are part of the output.</li>
</ol>
<div class="cell" data-execution_count="199">
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>df.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="195">
<pre><code>['integer', 'date', 'float', 'string']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="200">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="196">
<pre><code>(3, 4)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="201">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>df.height <span class="co"># probably more useful than df.shape[0]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="197">
<pre><code>3</code></pre>
</div>
</div>
<div class="cell" data-execution_count="202">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>df.width</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="198">
<pre><code>4</code></pre>
</div>
</div>
<div class="cell" data-execution_count="203">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a>df.schema <span class="co"># similar to pandas info()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="199">
<pre><code>{'integer': Int64,
 'date': Datetime(tu='us', tz=None),
 'float': Float64,
 'string': Utf8}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="204">
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a>df.with_row_count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="200">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 5)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
row_nr
</th>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
u32
</td>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
1
</td>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Add a single column</p>
<div class="cell" data-execution_count="205">
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>df.with_column(pl.Series(<span class="st">"new"</span>, [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="201">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 5)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
<th>
new
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Add multiple columns</p>
<div class="cell" data-execution_count="206">
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a>df.with_columns([</span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>  pl.Series(<span class="st">"new1"</span>, [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]),</span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>  pl.Series(<span class="st">"new2"</span>, [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>])])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="202">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 6)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
<th>
new1
</th>
<th>
new2
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
<td>
1
</td>
<td>
4
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
<td>
2
</td>
<td>
5
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
<td>
3
</td>
<td>
6
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="207">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>df.clone() <span class="co"># deep copy</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="203">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The following commands make changes in place; I am thus creating a copy of <code>df</code>.</p>
<div class="cell" data-execution_count="208">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a>df_copy <span class="op">=</span> df.clone() <span class="co"># making a copy since </span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>df_copy.insert_at_idx(<span class="dv">1</span>, pl.Series(<span class="st">"new"</span>, [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="204">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 5)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
new
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
</tr>
<tr>
<td>
3
</td>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="209">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>df_copy.replace_at_idx(<span class="dv">0</span>, pl.Series(<span class="st">"new2"</span>, [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="205">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 5)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
new2
</th>
<th>
new
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
</tr>
<tr>
<td>
3
</td>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="210">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>df_copy.replace(<span class="st">'float'</span>, pl.Series(<span class="st">"new_float"</span>, [<span class="fl">4.0</span>, <span class="fl">5.0</span>, <span class="fl">6.0</span>])) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="206">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 5)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
new2
</th>
<th>
new
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
</tr>
<tr>
<td>
3
</td>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="211">
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> foo(frame):</span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> frame.with_column(pl.Series(<span class="st">"new"</span>, [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]))</span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a>df.pipe(foo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="207">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 5)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
<th>
new
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="212">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>df.is_empty()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="208">
<pre><code>False</code></pre>
</div>
</div>
<div class="cell" data-execution_count="213">
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a>df.cleared() <span class="co"># make empty copy</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="209">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (0, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="214">
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a>df.cleared().is_empty()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="210">
<pre><code>True</code></pre>
</div>
</div>
<p>Renaming columns can be done with <code>rename()</code>. Later, we will see it may also be done with an <code>alias()</code> statement withing a <code>with_columns()</code> context.</p>
<div class="cell" data-execution_count="215">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>df.rename({<span class="st">'integer'</span>: <span class="st">'integer2'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="211">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer2
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="convert-to-other-python-objects" class="level2">
<h2 class="anchored" data-anchor-id="convert-to-other-python-objects">Convert to Other Python Objects</h2>
<p>TODO</p>
<section id="to-pandas" class="level3">
<h3 class="anchored" data-anchor-id="to-pandas">To Pandas</h3>
</section>
<section id="to-numpy" class="level3">
<h3 class="anchored" data-anchor-id="to-numpy">To Numpy</h3>
</section>
<section id="to-python-list" class="level3">
<h3 class="anchored" data-anchor-id="to-python-list">To Python List</h3>
</section>
<section id="to-python-dict" class="level3">
<h3 class="anchored" data-anchor-id="to-python-dict">To Python Dict</h3>
</section>
<section id="to-python-tuple" class="level3">
<h3 class="anchored" data-anchor-id="to-python-tuple">To Python Tuple</h3>
</section>
</section>
<section id="dataframe-in-memory" class="level2">
<h2 class="anchored" data-anchor-id="dataframe-in-memory">Dataframe in Memory</h2>
<div class="cell" data-execution_count="216">
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a>df.estimated_size(unit<span class="op">=</span><span class="st">"gb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="212">
<pre><code>9.96515154838562e-08</code></pre>
</div>
</div>
<div class="cell" data-execution_count="217">
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>df.n_chunks() <span class="co"># number of ChunkedArrays in the dataframe</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="213">
<pre><code>1</code></pre>
</div>
</div>
<div class="cell" data-execution_count="218">
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a>df.rechunk() <span class="co"># ensure contiguous memory layout</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="214">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="219">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a>df.shrink_to_fit() <span class="co"># reduce memory allocation to actual size</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="215">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="statistical-aggregations" class="level2">
<h2 class="anchored" data-anchor-id="statistical-aggregations">Statistical Aggregations</h2>
<div class="cell" data-execution_count="220">
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="216">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (7, 5)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
describe
</th>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
str
</td>
<td>
f64
</td>
<td>
str
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"count"
</td>
<td>
3.0
</td>
<td>
"3"
</td>
<td>
3.0
</td>
<td>
"3"
</td>
</tr>
<tr>
<td>
"null_count"
</td>
<td>
0.0
</td>
<td>
"0"
</td>
<td>
0.0
</td>
<td>
"0"
</td>
</tr>
<tr>
<td>
"mean"
</td>
<td>
2.0
</td>
<td>
null
</td>
<td>
5.0
</td>
<td>
null
</td>
</tr>
<tr>
<td>
"std"
</td>
<td>
1.0
</td>
<td>
null
</td>
<td>
1.0
</td>
<td>
null
</td>
</tr>
<tr>
<td>
"min"
</td>
<td>
1.0
</td>
<td>
"2022-01-01 00:...
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
"max"
</td>
<td>
3.0
</td>
<td>
"2022-01-03 00:...
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
<tr>
<td>
"median"
</td>
<td>
2.0
</td>
<td>
null
</td>
<td>
5.0
</td>
<td>
null
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Compare to pandas:</p>
<div class="cell" data-execution_count="221">
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>df.to_pandas().describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="217">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>integer</th>
      <th>float</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.5</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2.5</td>
      <td>5.5</td>
    </tr>
    <tr>
      <th>max</th>
      <td>3.0</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Things to note:</p>
<ul>
<li>Polas will summarize all columns, even if they are not numeric.</li>
<li>The statistics returned are different.</li>
<li>In the following, Polars will always return a frame with the same number of columns as the original frame; pandas would have returned columns only where the operation is defined, and omit NAs.</li>
</ul>
<p>Statistical aggregations operate column-wise (and in parallel).</p>
<div class="cell" data-execution_count="222">
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="218">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (1, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="223">
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">min</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="219">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (1, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="224">
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a>df.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="220">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (1, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
f64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2.0
</td>
<td>
null
</td>
<td>
5.0
</td>
<td>
null
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="225">
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a>df.median()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="221">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (1, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
f64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2.0
</td>
<td>
null
</td>
<td>
5.0
</td>
<td>
null
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="226">
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="222">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (1, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
6
</td>
<td>
null
</td>
<td>
15.0
</td>
<td>
null
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="227">
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a>df.std()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="223">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (1, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
f64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1.0
</td>
<td>
null
</td>
<td>
1.0
</td>
<td>
null
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="228">
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a>df.quantile(<span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="224">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (1, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
f64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1.0
</td>
<td>
null
</td>
<td>
4.0
</td>
<td>
null
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="exctraction" class="level2">
<h2 class="anchored" data-anchor-id="exctraction">Exctraction</h2>
<ol type="1">
<li>If you are used to pandas, recall there is no index. There is thus no need for <code>loc</code> vs.&nbsp;<code>iloc</code>, <code>reset_index()</code>, etc.</li>
<li>Filtering and selection is possible with the <code>[</code> operator, or the <code>filter()</code> and <code>select()</code> methods. The latter is recommended to facilitate lazy evaluation (discussed later).</li>
</ol>
<p>Single cell extraction.</p>
<div class="cell" data-execution_count="229">
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a>df[<span class="dv">0</span>,<span class="dv">0</span>] <span class="co"># like pandas .iloc[]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="225">
<pre><code>1</code></pre>
</div>
</div>
<p>Slicing along rows.</p>
<div class="cell" data-execution_count="230">
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a>df[<span class="dv">0</span>:<span class="dv">1</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="226">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (1, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Slicing along columns.</p>
<div class="cell" data-execution_count="231">
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a>df[:,<span class="dv">0</span>:<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="227">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 1)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="filtering-rows" class="level3">
<h3 class="anchored" data-anchor-id="filtering-rows">Filtering Rows</h3>
<div class="cell" data-execution_count="232">
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="228">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="233">
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a>df.limit(<span class="dv">2</span>) <span class="co"># same as pl.head()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="229">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="234">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a>df.tail(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="230">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (1, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="235">
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a>df.take_every(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="231">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="236">
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">slice</span>(offset<span class="op">=</span><span class="dv">1</span>, length<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="232">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (1, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="237">
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a>df.sample(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="233">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (1, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="238">
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a>df.row(<span class="dv">1</span>) <span class="co"># get row as tuple</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="234">
<pre><code>(2, datetime.datetime(2022, 1, 2, 0, 0), 5.0, 'b')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="239">
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a>df.rows() <span class="co"># all rows as list of tuples</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="235">
<pre><code>[(1, datetime.datetime(2022, 1, 1, 0, 0), 4.0, 'a'),
 (2, datetime.datetime(2022, 1, 2, 0, 0), 5.0, 'b'),
 (3, datetime.datetime(2022, 1, 3, 0, 0), 6.0, 'c')]</code></pre>
</div>
</div>
<p>Row filtering by label</p>
<div class="cell" data-execution_count="240">
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">filter</span>(pl.col(<span class="st">"integer"</span>) <span class="op">==</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="236">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (1, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Things to note:</p>
<ul>
<li>The <code>[</code> operator does not support indexing with boolean such as <code>df[df["integer"] == 2]</code>.</li>
<li>The <code>filter()</code> method is recommended over <code>[</code> by the authors of polars, to facilitate lazy evaluation (discussed later).</li>
</ul>
</section>
<section id="selecting-columns" class="level3">
<h3 class="anchored" data-anchor-id="selecting-columns">Selecting Columns</h3>
<p>Column selection by label</p>
<div class="cell" data-execution_count="241">
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a>df.select(<span class="st">"integer"</span>)</span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a><span class="co"># or df['integer']</span></span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a><span class="co"># or df[:,'integer']</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="237">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 1)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Multiple column selection by label</p>
<div class="cell" data-execution_count="242">
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a>df.select([<span class="st">"integer"</span>, <span class="st">"float"</span>])</span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a><span class="co"># or df[['integer', 'float']]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="238">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 2)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
float
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
4.0
</td>
</tr>
<tr>
<td>
2
</td>
<td>
5.0
</td>
</tr>
<tr>
<td>
3
</td>
<td>
6.0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Column slicing by label</p>
<div class="cell" data-execution_count="243">
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a>df[:,<span class="st">"integer"</span>:<span class="st">"float"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="239">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 3)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Note: Slicing with <code>df.select()</code> does not support ranges such as <code>df.select("integer":"float")</code>; only lists of column names.</p>
<p>Get a column as a 1D polars frame.</p>
<div class="cell" data-execution_count="244">
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a>df.get_column(<span class="st">'integer'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="240">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Get a column as a polars series.</p>
<div class="cell" data-execution_count="245">
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a>df.to_series(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="241">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="246">
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a>df.find_idx_by_name(<span class="st">'float'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="242">
<pre><code>2</code></pre>
</div>
</div>
<div class="cell" data-execution_count="247">
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a>df.get_columns() <span class="co"># get a list of series</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="243">
<pre><code>[shape: (3,)
 Series: 'integer' [i64]
 [
    1
    2
    3
 ],
 shape: (3,)
 Series: 'date' [datetime[μs]]
 [
    2022-01-01 00:00:00
    2022-01-02 00:00:00
    2022-01-03 00:00:00
 ],
 shape: (3,)
 Series: 'float' [f64]
 [
    4.0
    5.0
    6.0
 ],
 shape: (3,)
 Series: 'string' [str]
 [
    "a"
    "b"
    "c"
 ]]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="248">
<div class="sourceCode cell-code" id="cb320"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a>df.drop(<span class="st">"integer"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="244">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 3)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
</tr>
<tr>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Polars will not have an <code>inplace</code> argument. Use <code>df.drop_in_place()</code> instead.</p>
<p>Select along dtype</p>
<div class="cell" data-execution_count="249">
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a>df.select(pl.col(pl.Int64))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="245">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 1)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="250">
<div class="sourceCode cell-code" id="cb322"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a>df.select(pl.col(pl.Float64))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="246">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 1)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
float
</th>
</tr>
<tr>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
4.0
</td>
</tr>
<tr>
<td>
5.0
</td>
</tr>
<tr>
<td>
6.0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="251">
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a>df.select(pl.col(pl.Utf8))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="247">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 1)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
string
</th>
</tr>
<tr>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"a"
</td>
</tr>
<tr>
<td>
"b"
</td>
</tr>
<tr>
<td>
"c"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Things to note:</p>
<ul>
<li>The <code>pl.col()</code> function will be very useful for referencing columns in a dataframe. It may extract a single column, a list, a particular (polars) dtype, a regex pattern, or simply all columns.</li>
<li>When exctracting along dtype, use polars’ dtypes, not pandas’ dtypes. For example, use <code>pl.Int64</code> instead of <code>np.int64</code>.</li>
</ul>
</section>
<section id="selecting-a-single-item" class="level3">
<h3 class="anchored" data-anchor-id="selecting-a-single-item">Selecting A Single Item</h3>
<p>Exctracts the first element as a scalar. Useful when you output a single number as a frame object.</p>
<div class="cell" data-execution_count="252">
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a>pl.DataFrame([<span class="dv">1</span>]).item() <span class="co"># notice the output is not a frame, rather, a scalar.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="248">
<pre><code>1</code></pre>
</div>
</div>
</section>
</section>
<section id="uniques-and-duplicates-1" class="level2">
<h2 class="anchored" data-anchor-id="uniques-and-duplicates-1">Uniques and Duplicates</h2>
<div class="cell" data-execution_count="253">
<div class="sourceCode cell-code" id="cb326"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a>df.is_unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="249">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
bool
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
true
</td>
</tr>
<tr>
<td>
true
</td>
</tr>
<tr>
<td>
true
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="254">
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a>df.is_duplicated()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="250">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3,)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>

</th>
</tr>
<tr>
<td>
bool
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
false
</td>
</tr>
<tr>
<td>
false
</td>
</tr>
<tr>
<td>
false
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="255">
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a>df.unique() <span class="co"># same as pd.drop_duplicates()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="251">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="256">
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a>df.n_unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="252">
<pre><code>3</code></pre>
</div>
</div>
</section>
<section id="missing-1" class="level2">
<h2 class="anchored" data-anchor-id="missing-1">Missing</h2>
<div class="cell" data-execution_count="257">
<div class="sourceCode cell-code" id="cb331"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a>df_with_nulls <span class="op">=</span> df.with_columns([</span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true" tabindex="-1"></a>    pl.Series(<span class="st">"missing"</span>, [<span class="dv">3</span>, <span class="va">None</span>, np.nan]),</span>
<span id="cb331-3"><a href="#cb331-3" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="258">
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a>df_with_nulls.null_count() <span class="co"># same as pd.isnull().sum()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="254">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (1, 5)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
<th>
missing
</th>
</tr>
<tr>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="259">
<div class="sourceCode cell-code" id="cb333"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a>df_with_nulls.drop_nulls() <span class="co"># same as pd.dropna()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="255">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2, 5)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
<th>
missing
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
<td>
3.0
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
<td>
NaN
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="260">
<div class="sourceCode cell-code" id="cb334"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a>df_with_nulls.fill_null(<span class="dv">0</span>) <span class="co"># same as pd.fillna(0)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="256">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 5)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
<th>
missing
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
<td>
3.0
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
<td>
0.0
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
<td>
NaN
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>But recall that <code>None</code> and <code>np.nan</code> are not the same thing.</p>
<div class="cell" data-execution_count="261">
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a>df_with_nulls.fill_nan(<span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="257">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 5)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
<th>
missing
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
<td>
3.0
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
<td>
null
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
<td>
99.0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="262">
<div class="sourceCode cell-code" id="cb336"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a>df_with_nulls.interpolate()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="258">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 5)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
<th>
missing
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
<td>
3.0
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
<td>
NaN
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
<td>
NaN
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="transformations" class="level2">
<h2 class="anchored" data-anchor-id="transformations">Transformations</h2>
<ul>
<li>The general idea of colum trasformation is to wrap all transformations in a <code>with_columns()</code> method, and the select colums to operat on with <code>pl.col()</code>.</li>
<li>The output column will have the same name as the input, unless you use the <code>alias()</code> method to rename it.</li>
<li>The <code>with_columns()</code> is called a <strong>polars context</strong>.</li>
<li>The flavor of the <code>with_columns()</code> context is similar to pandas’ <code>assign()</code>.</li>
<li>One can use <code>df.iter_rows()</code> to get an iterator over rows.</li>
</ul>
<div class="cell" data-execution_count="263">
<div class="sourceCode cell-code" id="cb337"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a>df.with_columns([</span>
<span id="cb337-2"><a href="#cb337-2" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"integer"</span>).alias(<span class="st">"integer2"</span>),</span>
<span id="cb337-3"><a href="#cb337-3" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"integer"</span>) <span class="op">*</span> <span class="dv">2</span></span>
<span id="cb337-4"><a href="#cb337-4" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="259">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 5)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
<th>
integer2
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
<td>
1
</td>
</tr>
<tr>
<td>
4
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
<td>
2
</td>
</tr>
<tr>
<td>
6
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Things to note:</p>
<ul>
<li>The column <code>integer</code> is copied, by renaming it to <code>integer2</code>.</li>
<li>The columns <code>integer</code> is multiplied by 2 in place, because no <code>alias</code> is used.</li>
<li>You cannot use <code>[</code> to assign! This would not have worked <code>df['integer3'] = df['integer'] * 2</code></li>
</ul>
<p>If a selection returns multiple columns, all will be transformed:</p>
<div class="cell" data-execution_count="264">
<div class="sourceCode cell-code" id="cb338"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a>df.with_columns([</span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true" tabindex="-1"></a>    pl.col([pl.Int64,pl.Float64])<span class="op">*</span><span class="dv">2</span></span>
<span id="cb338-3"><a href="#cb338-3" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="260">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
8.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
4
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
10.0
</td>
<td>
"b"
</td>
</tr>
<tr>
<td>
6
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
12.0
</td>
<td>
"c"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="265">
<div class="sourceCode cell-code" id="cb339"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a>df.with_columns([</span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a>    pl.<span class="bu">all</span>()<span class="op">*</span><span class="dv">2</span></span>
<span id="cb339-3"><a href="#cb339-3" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>thread '&lt;unnamed&gt;' panicked at 'data types don't match: InvalidOperation(Owned("multiplication operation not supported for shape: (3,)\nChunkedArray: 'string' [str]\n[\n\t\"a\"\n\t\"b\"\n\t\"c\"\n] and shape: (1,)\nSeries: 'literal' [str]\n[\n\t\"2\"\n]"))', /home/runner/work/polars/polars/polars/polars-core/src/series/arithmetic/borrowed.rs:467:44
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>PanicException: data types don't match: InvalidOperation(Owned("multiplication operation not supported for shape: (3,)\nChunkedArray: 'string' [str]\n[\n\t\"a\"\n\t\"b\"\n\t\"c\"\n] and shape: (1,)\nSeries: 'literal' [str]\n[\n\t\"2\"\n]"))</code></pre>
</div>
</div>
<p>Apply your own labda function.</p>
<div class="cell" data-execution_count="266">
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a>df.select([pl.col(<span class="st">"integer"</span>), pl.col(<span class="st">"float"</span>)]).<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="dv">0</span>] <span class="op">+</span> x[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="262">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 1)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
apply
</th>
</tr>
<tr>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
5.0
</td>
</tr>
<tr>
<td>
7.0
</td>
</tr>
<tr>
<td>
9.0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>But wait- using your own functions may have a very serious toll on perforance:</p>
<div class="cell" data-execution_count="267">
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a>df_big <span class="op">=</span> pl.DataFrame(np.random.randn(<span class="dv">1000000</span>, <span class="dv">2</span>), columns<span class="op">=</span>[<span class="st">"a"</span>, <span class="st">"b"</span>])</span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n2 <span class="op">-</span>r2 df_big.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>6.58 ms ± 403 µs per loop (mean ± std. dev. of 2 runs, 2 loops each)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="268">
<div class="sourceCode cell-code" id="cb345"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n2 <span class="op">-</span>r2 df_big.<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="dv">0</span>] <span class="op">+</span> x[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>412 ms ± 12.5 ms per loop (mean ± std. dev. of 2 runs, 2 loops each)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="269">
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a>df.shift(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="265">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
null
</td>
<td>
null
</td>
<td>
null
</td>
<td>
null
</td>
</tr>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="270">
<div class="sourceCode cell-code" id="cb348"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a>df.shift_and_fill(<span class="dv">1</span>, <span class="st">'WOW'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="266">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"WOW"
</td>
<td>
"WOW"
</td>
<td>
"WOW"
</td>
<td>
"WOW"
</td>
</tr>
<tr>
<td>
"1"
</td>
<td>
"2022-01-01 00:...
</td>
<td>
"4.0"
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
"2"
</td>
<td>
"2022-01-02 00:...
</td>
<td>
"5.0"
</td>
<td>
"b"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="sorting" class="level2">
<h2 class="anchored" data-anchor-id="sorting">Sorting</h2>
<div class="cell" data-execution_count="271">
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a>df.sort(<span class="st">"integer"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="267">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="272">
<div class="sourceCode cell-code" id="cb350"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a>df.reverse()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="268">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
</tr>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="joins" class="level2">
<h2 class="anchored" data-anchor-id="joins">Joins</h2>
<p>High level:</p>
<ul>
<li><code>df.hstack()</code> for horizontal concatenation; like pandas <code>pd.concat([],axis=1)</code> or R’s cbind.</li>
<li><code>df.vstack()</code> for vertical concatenation; like pandas <code>pd.concat([],axis=0)</code> or R’s rbind.</li>
<li><code>df.join()</code> for joins; like pandas <code>pd.merge()</code> or <code>df.join()</code>.</li>
</ul>
<div class="cell" data-execution_count="273">
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a>new_column <span class="op">=</span> pl.Series(<span class="st">"c"</span>, np.repeat(<span class="dv">1</span>, df.height))</span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-3"><a href="#cb351-3" aria-hidden="true" tabindex="-1"></a>df.hstack([new_column])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="269">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 5)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
<th>
c
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
<td>
1
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
<td>
1
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="274">
<div class="sourceCode cell-code" id="cb352"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pl.DataFrame({</span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"integer"</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], </span>
<span id="cb352-3"><a href="#cb352-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"date"</span>: [</span>
<span id="cb352-4"><a href="#cb352-4" aria-hidden="true" tabindex="-1"></a>    (datetime(<span class="dv">2022</span>, <span class="dv">1</span>, <span class="dv">4</span>)), </span>
<span id="cb352-5"><a href="#cb352-5" aria-hidden="true" tabindex="-1"></a>    (datetime(<span class="dv">2022</span>, <span class="dv">1</span>, <span class="dv">5</span>)), </span>
<span id="cb352-6"><a href="#cb352-6" aria-hidden="true" tabindex="-1"></a>    (datetime(<span class="dv">2022</span>, <span class="dv">1</span>, <span class="dv">6</span>))], </span>
<span id="cb352-7"><a href="#cb352-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"float"</span>:[<span class="fl">7.0</span>, <span class="fl">8.0</span>, <span class="fl">9.0</span>],</span>
<span id="cb352-8"><a href="#cb352-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"string"</span>: [<span class="st">"d"</span>, <span class="st">"d"</span>, <span class="st">"d"</span>]})</span>
<span id="cb352-9"><a href="#cb352-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-10"><a href="#cb352-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-11"><a href="#cb352-11" aria-hidden="true" tabindex="-1"></a>df.vstack(df2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="270">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (6, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
<tr>
<td>
1
</td>
<td>
2022-01-04 00:00:00
</td>
<td>
7.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-05 00:00:00
</td>
<td>
8.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-06 00:00:00
</td>
<td>
9.0
</td>
<td>
"d"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="275">
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a>df.extend(df2) <span class="co"># like vstack, but with memory re-chunking. Similar to df.vstack().rechunk()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="271">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (6, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
<tr>
<td>
1
</td>
<td>
2022-01-04 00:00:00
</td>
<td>
7.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-05 00:00:00
</td>
<td>
8.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-06 00:00:00
</td>
<td>
9.0
</td>
<td>
"d"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="276">
<div class="sourceCode cell-code" id="cb354"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a>df.merge_sorted(df2, key<span class="op">=</span><span class="st">"integer"</span>) <span class="co"># vstacking with sorting (aka riffle-shuffle).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="272">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (9, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
1
</td>
<td>
2022-01-04 00:00:00
</td>
<td>
7.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-05 00:00:00
</td>
<td>
8.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
<tr>
<td>
1
</td>
<td>
2022-01-04 00:00:00
</td>
<td>
7.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-05 00:00:00
</td>
<td>
8.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-06 00:00:00
</td>
<td>
9.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-06 00:00:00
</td>
<td>
9.0
</td>
<td>
"d"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><strong>Caution</strong>: Joining along rows is possible only if matched columns have the same dtype. Timestamps may be tricky because they may have different time units. Recall that timeunits may be cast before joining using <code>series.dt.cast_time_unit()</code>:</p>
<div class="cell" data-execution_count="277">
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a>df.with_column(</span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a>    pl.col(pl.Datetime(<span class="st">"ns"</span>)).dt.cast_time_unit(tu<span class="op">=</span><span class="st">"ms"</span>)</span>
<span id="cb355-3"><a href="#cb355-3" aria-hidden="true" tabindex="-1"></a>)            </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="278">
<div class="sourceCode cell-code" id="cb356"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a>df.join(df2, on<span class="op">=</span><span class="st">"integer"</span>, how<span class="op">=</span><span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="273">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (6, 7)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
<th>
date_right
</th>
<th>
float_right
</th>
<th>
string_right
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
<td>
2022-01-04 00:00:00
</td>
<td>
7.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-02 00:00:00
</td>
<td>
5.0
</td>
<td>
"b"
</td>
<td>
2022-01-05 00:00:00
</td>
<td>
8.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
<td>
2022-01-06 00:00:00
</td>
<td>
9.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
1
</td>
<td>
2022-01-04 00:00:00
</td>
<td>
7.0
</td>
<td>
"d"
</td>
<td>
2022-01-04 00:00:00
</td>
<td>
7.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2022-01-05 00:00:00
</td>
<td>
8.0
</td>
<td>
"d"
</td>
<td>
2022-01-05 00:00:00
</td>
<td>
8.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2022-01-06 00:00:00
</td>
<td>
9.0
</td>
<td>
"d"
</td>
<td>
2022-01-06 00:00:00
</td>
<td>
9.0
</td>
<td>
"d"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Things to note:</p>
<ul>
<li>Repeating column names have been suffixed with “_right”.</li>
<li>Unlike pandas, there are no indices. The <code>on</code>/<code>left_on</code>/<code>right_on</code> argument is always required.</li>
<li><code>how=</code> may take the following values: ‘inner’, ‘left’, ‘outer’, ‘semi’, ‘anti’, ‘cross’.</li>
<li>The join is super fast, as demonstrated in the Motivation section above.</li>
</ul>
<div class="cell" data-execution_count="279">
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a>df.join_asof(df2, left_on<span class="op">=</span><span class="st">"date"</span>, right_on<span class="op">=</span><span class="st">'date2'</span>, by<span class="op">=</span><span class="st">"integer"</span>, strategy<span class="op">=</span><span class="st">"backward"</span>, tolerance<span class="op">=</span><span class="st">'1w'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NotFoundError: date2</code></pre>
</div>
</div>
<p>Things to note:</p>
<ul>
<li>Yes! <code>merge_asof()</code> is also available.</li>
<li>The <code>strategy=</code> argument may take the following values: ‘backward’, ‘forward’.</li>
<li>The <code>tolerance=</code> argument may take the following values: ‘1w’, ‘1d’, ‘1h’, ‘1m’, ‘1s’, ‘1ms’, ‘1us’, ‘1ns’.</li>
</ul>
</section>
<section id="reshaping" class="level2">
<h2 class="anchored" data-anchor-id="reshaping">Reshaping</h2>
<div class="cell" data-execution_count="280">
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a>df.transpose()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="275">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (4, 6)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
column_0
</th>
<th>
column_1
</th>
<th>
column_2
</th>
<th>
column_3
</th>
<th>
column_4
</th>
<th>
column_5
</th>
</tr>
<tr>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"1"
</td>
<td>
"2"
</td>
<td>
"3"
</td>
<td>
"1"
</td>
<td>
"2"
</td>
<td>
"3"
</td>
</tr>
<tr>
<td>
"2022-01-01 00:...
</td>
<td>
"2022-01-02 00:...
</td>
<td>
"2022-01-03 00:...
</td>
<td>
"2022-01-04 00:...
</td>
<td>
"2022-01-05 00:...
</td>
<td>
"2022-01-06 00:...
</td>
</tr>
<tr>
<td>
"4.0"
</td>
<td>
"5.0"
</td>
<td>
"6.0"
</td>
<td>
"7.0"
</td>
<td>
"8.0"
</td>
<td>
"9.0"
</td>
</tr>
<tr>
<td>
"a"
</td>
<td>
"b"
</td>
<td>
"c"
</td>
<td>
"d"
</td>
<td>
"d"
</td>
<td>
"d"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="wide-to-long" class="level3">
<h3 class="anchored" data-anchor-id="wide-to-long">Wide to Long</h3>
<div class="cell" data-execution_count="281">
<div class="sourceCode cell-code" id="cb360"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The following example is adapted from Pandas documentation: https://pandas.pydata.org/docs/reference/api/pandas.wide_to_long.html</span></span>
<span id="cb360-2"><a href="#cb360-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-3"><a href="#cb360-3" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb360-4"><a href="#cb360-4" aria-hidden="true" tabindex="-1"></a>wide <span class="op">=</span> pl.DataFrame({</span>
<span id="cb360-5"><a href="#cb360-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'famid'</span>: [<span class="st">"11"</span>, <span class="st">"12"</span>, <span class="st">"13"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"3"</span>, <span class="st">"3"</span>],</span>
<span id="cb360-6"><a href="#cb360-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'birth'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb360-7"><a href="#cb360-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ht1'</span>: [<span class="fl">2.8</span>, <span class="fl">2.9</span>, <span class="fl">2.2</span>, <span class="dv">2</span>, <span class="fl">1.8</span>, <span class="fl">1.9</span>, <span class="fl">2.2</span>, <span class="fl">2.3</span>, <span class="fl">2.1</span>],</span>
<span id="cb360-8"><a href="#cb360-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ht2'</span>: [<span class="fl">3.4</span>, <span class="fl">3.8</span>, <span class="fl">2.9</span>, <span class="fl">3.2</span>, <span class="fl">2.8</span>, <span class="fl">2.4</span>, <span class="fl">3.3</span>, <span class="fl">3.4</span>, <span class="fl">2.9</span>]})</span>
<span id="cb360-9"><a href="#cb360-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-10"><a href="#cb360-10" aria-hidden="true" tabindex="-1"></a>wide.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="276">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
famid
</th>
<th>
birth
</th>
<th>
ht1
</th>
<th>
ht2
</th>
</tr>
<tr>
<td>
str
</td>
<td>
i64
</td>
<td>
f64
</td>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"11"
</td>
<td>
1
</td>
<td>
2.8
</td>
<td>
3.4
</td>
</tr>
<tr>
<td>
"12"
</td>
<td>
2
</td>
<td>
2.9
</td>
<td>
3.8
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="282">
<div class="sourceCode cell-code" id="cb361"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a>wide.melt(</span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a>  id_vars<span class="op">=</span>[<span class="st">'famid'</span>, <span class="st">'birth'</span>], </span>
<span id="cb361-3"><a href="#cb361-3" aria-hidden="true" tabindex="-1"></a>  value_vars<span class="op">=</span>[<span class="st">'ht1'</span>, <span class="st">'ht2'</span>], </span>
<span id="cb361-4"><a href="#cb361-4" aria-hidden="true" tabindex="-1"></a>  variable_name<span class="op">=</span><span class="st">'treatment'</span>, </span>
<span id="cb361-5"><a href="#cb361-5" aria-hidden="true" tabindex="-1"></a>  value_name<span class="op">=</span><span class="st">'height'</span>).sample(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="277">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (5, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
famid
</th>
<th>
birth
</th>
<th>
treatment
</th>
<th>
height
</th>
</tr>
<tr>
<td>
str
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"2"
</td>
<td>
3
</td>
<td>
"ht1"
</td>
<td>
1.9
</td>
</tr>
<tr>
<td>
"2"
</td>
<td>
2
</td>
<td>
"ht2"
</td>
<td>
2.8
</td>
</tr>
<tr>
<td>
"11"
</td>
<td>
1
</td>
<td>
"ht2"
</td>
<td>
3.4
</td>
</tr>
<tr>
<td>
"3"
</td>
<td>
1
</td>
<td>
"ht1"
</td>
<td>
2.2
</td>
</tr>
<tr>
<td>
"3"
</td>
<td>
2
</td>
<td>
"ht2"
</td>
<td>
3.4
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Break strings into rows.</p>
<div class="cell" data-execution_count="283">
<div class="sourceCode cell-code" id="cb362"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a>wide.explode(columns<span class="op">=</span>[<span class="st">'famid'</span>]).limit(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="278">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (5, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
famid
</th>
<th>
birth
</th>
<th>
ht1
</th>
<th>
ht2
</th>
</tr>
<tr>
<td>
str
</td>
<td>
i64
</td>
<td>
f64
</td>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"1"
</td>
<td>
1
</td>
<td>
2.8
</td>
<td>
3.4
</td>
</tr>
<tr>
<td>
"1"
</td>
<td>
1
</td>
<td>
2.8
</td>
<td>
3.4
</td>
</tr>
<tr>
<td>
"1"
</td>
<td>
2
</td>
<td>
2.9
</td>
<td>
3.8
</td>
</tr>
<tr>
<td>
"2"
</td>
<td>
2
</td>
<td>
2.9
</td>
<td>
3.8
</td>
</tr>
<tr>
<td>
"1"
</td>
<td>
3
</td>
<td>
2.2
</td>
<td>
2.9
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="long-to-wide" class="level3">
<h3 class="anchored" data-anchor-id="long-to-wide">Long to Wide</h3>
<div class="cell" data-execution_count="284">
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example adapted from https://stackoverflow.com/questions/5890584/how-to-reshape-data-from-long-to-wide-format</span></span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a><span class="bu">long</span> <span class="op">=</span> pl.DataFrame({</span>
<span id="cb363-4"><a href="#cb363-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'id'</span>: [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>],</span>
<span id="cb363-5"><a href="#cb363-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'treatment'</span>: [<span class="st">'A'</span>, <span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'A'</span>, <span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'A'</span>, <span class="st">'A'</span>, <span class="st">'B'</span>],</span>
<span id="cb363-6"><a href="#cb363-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'height'</span>: [<span class="fl">2.8</span>, <span class="fl">2.9</span>, <span class="fl">2.2</span>, <span class="dv">2</span>, <span class="fl">1.8</span>, <span class="fl">1.9</span>, <span class="fl">2.2</span>, <span class="fl">2.3</span>, <span class="fl">2.1</span>]</span>
<span id="cb363-7"><a href="#cb363-7" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb363-8"><a href="#cb363-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb363-9"><a href="#cb363-9" aria-hidden="true" tabindex="-1"></a><span class="bu">long</span>.limit(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="279">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (5, 3)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
id
</th>
<th>
treatment
</th>
<th>
height
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
str
</td>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
"A"
</td>
<td>
2.8
</td>
</tr>
<tr>
<td>
1
</td>
<td>
"A"
</td>
<td>
2.9
</td>
</tr>
<tr>
<td>
1
</td>
<td>
"B"
</td>
<td>
2.2
</td>
</tr>
<tr>
<td>
2
</td>
<td>
"A"
</td>
<td>
2.0
</td>
</tr>
<tr>
<td>
2
</td>
<td>
"A"
</td>
<td>
1.8
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="285">
<div class="sourceCode cell-code" id="cb364"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="bu">long</span>.pivot(</span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a>  index<span class="op">=</span><span class="st">'id'</span>, </span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a>  columns<span class="op">=</span><span class="st">'treatment'</span>,</span>
<span id="cb364-4"><a href="#cb364-4" aria-hidden="true" tabindex="-1"></a>  values<span class="op">=</span><span class="st">'height'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="280">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 3)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
id
</th>
<th>
A
</th>
<th>
B
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
f64
</td>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
2.8
</td>
<td>
2.2
</td>
</tr>
<tr>
<td>
2
</td>
<td>
2.0
</td>
<td>
1.9
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2.2
</td>
<td>
2.1
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="286">
<div class="sourceCode cell-code" id="cb365"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="bu">long</span>.unstack(step<span class="op">=</span><span class="dv">2</span>) <span class="co"># works like a transpose, and then wrap rows. Change the `step=` to get the feeling. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="281">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2, 15)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
id_0
</th>
<th>
id_1
</th>
<th>
id_2
</th>
<th>
id_3
</th>
<th>
id_4
</th>
<th>
treatment_0
</th>
<th>
treatment_1
</th>
<th>
treatment_2
</th>
<th>
treatment_3
</th>
<th>
treatment_4
</th>
<th>
height_0
</th>
<th>
height_1
</th>
<th>
height_2
</th>
<th>
height_3
</th>
<th>
height_4
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
1
</td>
<td>
2
</td>
<td>
3
</td>
<td>
3
</td>
<td>
"A"
</td>
<td>
"B"
</td>
<td>
"A"
</td>
<td>
"A"
</td>
<td>
"B"
</td>
<td>
2.8
</td>
<td>
2.2
</td>
<td>
1.8
</td>
<td>
2.2
</td>
<td>
2.1
</td>
</tr>
<tr>
<td>
1
</td>
<td>
2
</td>
<td>
2
</td>
<td>
3
</td>
<td>
null
</td>
<td>
"A"
</td>
<td>
"A"
</td>
<td>
"B"
</td>
<td>
"A"
</td>
<td>
null
</td>
<td>
2.9
</td>
<td>
2.0
</td>
<td>
1.9
</td>
<td>
2.3
</td>
<td>
null
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="groupby" class="level2">
<h2 class="anchored" data-anchor-id="groupby">Groupby</h2>
<div class="cell" data-execution_count="287">
<div class="sourceCode cell-code" id="cb366"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pl.DataFrame({</span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"integer"</span>: [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>],</span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"float"</span>: [<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">3.0</span>, <span class="fl">4.0</span>, <span class="fl">5.0</span>, <span class="fl">6.0</span>],</span>
<span id="cb366-4"><a href="#cb366-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"string"</span>: [<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>, <span class="st">"e"</span>, <span class="st">"f"</span>],</span>
<span id="cb366-5"><a href="#cb366-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"datetime"</span>: [</span>
<span id="cb366-6"><a href="#cb366-6" aria-hidden="true" tabindex="-1"></a>        (datetime(<span class="dv">2022</span>, <span class="dv">1</span>, <span class="dv">4</span>)), </span>
<span id="cb366-7"><a href="#cb366-7" aria-hidden="true" tabindex="-1"></a>        (datetime(<span class="dv">2022</span>, <span class="dv">1</span>, <span class="dv">4</span>)), </span>
<span id="cb366-8"><a href="#cb366-8" aria-hidden="true" tabindex="-1"></a>        (datetime(<span class="dv">2022</span>, <span class="dv">1</span>, <span class="dv">4</span>)), </span>
<span id="cb366-9"><a href="#cb366-9" aria-hidden="true" tabindex="-1"></a>        (datetime(<span class="dv">2022</span>, <span class="dv">1</span>, <span class="dv">9</span>)), </span>
<span id="cb366-10"><a href="#cb366-10" aria-hidden="true" tabindex="-1"></a>        (datetime(<span class="dv">2022</span>, <span class="dv">1</span>, <span class="dv">9</span>)), </span>
<span id="cb366-11"><a href="#cb366-11" aria-hidden="true" tabindex="-1"></a>        (datetime(<span class="dv">2022</span>, <span class="dv">1</span>, <span class="dv">9</span>))],</span>
<span id="cb366-12"><a href="#cb366-12" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="288">
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a>df2.partition_by(<span class="st">"integer"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="283">
<pre><code>[shape: (2, 4)
 ┌─────────┬───────┬────────┬─────────────────────┐
 │ integer ┆ float ┆ string ┆ datetime            │
 │ ---     ┆ ---   ┆ ---    ┆ ---                 │
 │ i64     ┆ f64   ┆ str    ┆ datetime[μs]        │
 ╞═════════╪═══════╪════════╪═════════════════════╡
 │ 1       ┆ 1.0   ┆ a      ┆ 2022-01-04 00:00:00 │
 │ 1       ┆ 2.0   ┆ b      ┆ 2022-01-04 00:00:00 │
 └─────────┴───────┴────────┴─────────────────────┘,
 shape: (2, 4)
 ┌─────────┬───────┬────────┬─────────────────────┐
 │ integer ┆ float ┆ string ┆ datetime            │
 │ ---     ┆ ---   ┆ ---    ┆ ---                 │
 │ i64     ┆ f64   ┆ str    ┆ datetime[μs]        │
 ╞═════════╪═══════╪════════╪═════════════════════╡
 │ 2       ┆ 3.0   ┆ c      ┆ 2022-01-04 00:00:00 │
 │ 2       ┆ 4.0   ┆ d      ┆ 2022-01-09 00:00:00 │
 └─────────┴───────┴────────┴─────────────────────┘,
 shape: (2, 4)
 ┌─────────┬───────┬────────┬─────────────────────┐
 │ integer ┆ float ┆ string ┆ datetime            │
 │ ---     ┆ ---   ┆ ---    ┆ ---                 │
 │ i64     ┆ f64   ┆ str    ┆ datetime[μs]        │
 ╞═════════╪═══════╪════════╪═════════════════════╡
 │ 3       ┆ 5.0   ┆ e      ┆ 2022-01-09 00:00:00 │
 │ 3       ┆ 6.0   ┆ f      ┆ 2022-01-09 00:00:00 │
 └─────────┴───────┴────────┴─────────────────────┘]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="289">
<div class="sourceCode cell-code" id="cb369"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a>groupper <span class="op">=</span> df2.groupby(<span class="st">"integer"</span>)</span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a>groupper.count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="284">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 2)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
count
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2
</td>
<td>
2
</td>
</tr>
<tr>
<td>
1
</td>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
<td>
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="290">
<div class="sourceCode cell-code" id="cb370"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a>groupper.<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="285">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
float
</th>
<th>
string
</th>
<th>
datetime
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
f64
</td>
<td>
str
</td>
<td>
datetime[μs]
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
3.0
</td>
<td>
null
</td>
<td>
2074-01-07 00:00:00
</td>
</tr>
<tr>
<td>
2
</td>
<td>
7.0
</td>
<td>
null
</td>
<td>
2074-01-12 00:00:00
</td>
</tr>
<tr>
<td>
3
</td>
<td>
11.0
</td>
<td>
null
</td>
<td>
2074-01-17 00:00:00
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Groupby a fixed time window with <code>df.groupby_dynamic()</code>:</p>
<div class="cell" data-execution_count="291">
<div class="sourceCode cell-code" id="cb371"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a>  df2</span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true" tabindex="-1"></a>  .groupby_dynamic(index_column<span class="op">=</span><span class="st">"datetime"</span>, every<span class="op">=</span><span class="st">"1d"</span>)</span>
<span id="cb371-4"><a href="#cb371-4" aria-hidden="true" tabindex="-1"></a>  .agg(pl.col(<span class="st">"float"</span>).<span class="bu">sum</span>())</span>
<span id="cb371-5"><a href="#cb371-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="286">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2, 2)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
datetime
</th>
<th>
float
</th>
</tr>
<tr>
<td>
datetime[μs]
</td>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2022-01-04 00:00:00
</td>
<td>
6.0
</td>
</tr>
<tr>
<td>
2022-01-09 00:00:00
</td>
<td>
15.0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>If you do not want a single summary per period, rather, a window at each datapoint, use <code>df.groupby_rolling()</code>:</p>
<div class="cell" data-execution_count="292">
<div class="sourceCode cell-code" id="cb372"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a>  df2</span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true" tabindex="-1"></a>  .groupby_rolling(index_column<span class="op">=</span><span class="st">"datetime"</span>, period<span class="op">=</span><span class="st">'1d'</span>)</span>
<span id="cb372-4"><a href="#cb372-4" aria-hidden="true" tabindex="-1"></a>  .agg(pl.col(<span class="st">"float"</span>).<span class="bu">sum</span>())</span>
<span id="cb372-5"><a href="#cb372-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="287">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (6, 2)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
datetime
</th>
<th>
float
</th>
</tr>
<tr>
<td>
datetime[μs]
</td>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2022-01-04 00:00:00
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
2022-01-04 00:00:00
</td>
<td>
3.0
</td>
</tr>
<tr>
<td>
2022-01-04 00:00:00
</td>
<td>
6.0
</td>
</tr>
<tr>
<td>
2022-01-09 00:00:00
</td>
<td>
4.0
</td>
</tr>
<tr>
<td>
2022-01-09 00:00:00
</td>
<td>
9.0
</td>
</tr>
<tr>
<td>
2022-01-09 00:00:00
</td>
<td>
15.0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="query-planning-and-optimization" class="level1">
<h1>Query Planning and Optimization</h1>
<p>The take-home of this section, is that polar can take advantage of half-a-century’s worth of research in query planning and optimization. You will not have to think about the right order of operations, or the right data structures to use. Rather, replace the polars dataframe with a polars lazy-dataframe, state all the operations you want, and just finish with a <code>collect()</code>. Polars will take care of the rest, and provide you with the tools to understand its plan.</p>
<p>We will not go into the details of the difference between a lazy and a non-lazy dataframe. Just assume a lazy frame allows everything a non-lazy frame can do, but it does not execute the operations until you call <code>collect()</code>. This is not entirely true, but you will get an informative error if you try to do something that is not supported.</p>
<p>Get your lazy dataframe:</p>
<div class="cell" data-execution_count="293">
<div class="sourceCode cell-code" id="cb373"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a>df_lazy <span class="op">=</span> df.lazy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>State all your operations:</p>
<div class="cell" data-execution_count="294">
<div class="sourceCode cell-code" id="cb374"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> (</span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a>  df_lazy</span>
<span id="cb374-3"><a href="#cb374-3" aria-hidden="true" tabindex="-1"></a>  .<span class="bu">filter</span>(pl.col(<span class="st">"float"</span>) <span class="op">&gt;</span> <span class="fl">2.0</span>)</span>
<span id="cb374-4"><a href="#cb374-4" aria-hidden="true" tabindex="-1"></a>  .<span class="bu">filter</span>(pl.col(<span class="st">"float"</span>) <span class="op">&gt;</span> <span class="fl">3.0</span>)</span>
<span id="cb374-5"><a href="#cb374-5" aria-hidden="true" tabindex="-1"></a>  .<span class="bu">filter</span>(pl.col(<span class="st">"float"</span>) <span class="op">&gt;</span> <span class="fl">7.0</span>)</span>
<span id="cb374-6"><a href="#cb374-6" aria-hidden="true" tabindex="-1"></a>  .select([<span class="st">"integer"</span>])</span>
<span id="cb374-7"><a href="#cb374-7" aria-hidden="true" tabindex="-1"></a>  .sort(<span class="st">"integer"</span>)</span>
<span id="cb374-8"><a href="#cb374-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And now visualize the query.</p>
<div class="cell" data-execution_count="295">
<div class="sourceCode cell-code" id="cb375"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a>q <span class="co"># same as q.show_graph(optimized=False)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="290">

<h4 class="anchored" data-anchor-id="query-planning-and-optimization">NAIVE QUERY PLAN</h4><p>run <b>LazyFrame.show_graph()</b> to see the optimized version</p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?-->

<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: polars_query Pages: 1 -->
<svg width="258pt" height="421pt" viewbox="0.00 0.00 258.00 421.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 417)">
<title>polars_query</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-417 254,-417 254,4 -4,4"></polygon>
<!-- SORT BY [col(&quot;integer&quot;)] [(0, 0)] -->
<g id="node1" class="node">
<title>SORT BY [col("integer")] [(0, 0)]</title>
<polygon fill="none" stroke="black" points="221,-413 29,-413 29,-377 221,-377 221,-413"></polygon>
<text text-anchor="middle" x="125" y="-391.3" font-family="Times,serif" font-size="14.00">SORT BY [col("integer")]</text>
</g>
<!-- π 1/4 [(0, 1)] -->
<g id="node2" class="node">
<title>π 1/4 [(0, 1)]</title>
<polygon fill="none" stroke="black" points="152,-341 98,-341 98,-305 152,-305 152,-341"></polygon>
<text text-anchor="middle" x="125" y="-319.3" font-family="Times,serif" font-size="14.00">π 1/4</text>
</g>
<!-- SORT BY [col(&quot;integer&quot;)] [(0, 0)]&#45;&#45;π 1/4 [(0, 1)] -->
<g id="edge1" class="edge">
<title>SORT BY [col("integer")] [(0, 0)]--π 1/4 [(0, 1)]</title>
<path fill="none" stroke="black" d="M125,-376.7C125,-365.85 125,-351.92 125,-341.1"></path>
</g>
<!-- FILTER BY (col(&quot;float&quot;)) &gt; (7f64) [(0, 2)] -->
<g id="node3" class="node">
<title>FILTER BY (col("float")) &gt; (7f64) [(0, 2)]</title>
<polygon fill="none" stroke="black" points="250,-269 0,-269 0,-233 250,-233 250,-269"></polygon>
<text text-anchor="middle" x="125" y="-247.3" font-family="Times,serif" font-size="14.00">FILTER BY (col("float")) &gt; (7f64)</text>
</g>
<!-- π 1/4 [(0, 1)]&#45;&#45;FILTER BY (col(&quot;float&quot;)) &gt; (7f64) [(0, 2)] -->
<g id="edge2" class="edge">
<title>π 1/4 [(0, 1)]--FILTER BY (col("float")) &gt; (7f64) [(0, 2)]</title>
<path fill="none" stroke="black" d="M125,-304.7C125,-293.85 125,-279.92 125,-269.1"></path>
</g>
<!-- FILTER BY (col(&quot;float&quot;)) &gt; (3f64) [(0, 3)] -->
<g id="node4" class="node">
<title>FILTER BY (col("float")) &gt; (3f64) [(0, 3)]</title>
<polygon fill="none" stroke="black" points="250,-197 0,-197 0,-161 250,-161 250,-197"></polygon>
<text text-anchor="middle" x="125" y="-175.3" font-family="Times,serif" font-size="14.00">FILTER BY (col("float")) &gt; (3f64)</text>
</g>
<!-- FILTER BY (col(&quot;float&quot;)) &gt; (7f64) [(0, 2)]&#45;&#45;FILTER BY (col(&quot;float&quot;)) &gt; (3f64) [(0, 3)] -->
<g id="edge3" class="edge">
<title>FILTER BY (col("float")) &gt; (7f64) [(0, 2)]--FILTER BY (col("float")) &gt; (3f64) [(0, 3)]</title>
<path fill="none" stroke="black" d="M125,-232.7C125,-221.85 125,-207.92 125,-197.1"></path>
</g>
<!-- FILTER BY (col(&quot;float&quot;)) &gt; (2f64) [(0, 4)] -->
<g id="node5" class="node">
<title>FILTER BY (col("float")) &gt; (2f64) [(0, 4)]</title>
<polygon fill="none" stroke="black" points="250,-125 0,-125 0,-89 250,-89 250,-125"></polygon>
<text text-anchor="middle" x="125" y="-103.3" font-family="Times,serif" font-size="14.00">FILTER BY (col("float")) &gt; (2f64)</text>
</g>
<!-- FILTER BY (col(&quot;float&quot;)) &gt; (3f64) [(0, 3)]&#45;&#45;FILTER BY (col(&quot;float&quot;)) &gt; (2f64) [(0, 4)] -->
<g id="edge4" class="edge">
<title>FILTER BY (col("float")) &gt; (3f64) [(0, 3)]--FILTER BY (col("float")) &gt; (2f64) [(0, 4)]</title>
<path fill="none" stroke="black" d="M125,-160.7C125,-149.85 125,-135.92 125,-125.1"></path>
</g>
<!-- TABLE
π */4;
σ &#45;; [(0, 5)] -->
<g id="node6" class="node">
<title>TABLE
π */4;
σ -; [(0, 5)]</title>
<polygon fill="none" stroke="black" points="157.5,-53 92.5,-53 92.5,0 157.5,0 157.5,-53"></polygon>
<text text-anchor="middle" x="125" y="-37.8" font-family="Times,serif" font-size="14.00">TABLE</text>
<text text-anchor="middle" x="125" y="-22.8" font-family="Times,serif" font-size="14.00">π */4;</text>
<text text-anchor="middle" x="125" y="-7.8" font-family="Times,serif" font-size="14.00">σ -;</text>
</g>
<!-- FILTER BY (col(&quot;float&quot;)) &gt; (2f64) [(0, 4)]&#45;&#45;TABLE
π */4;
σ &#45;; [(0, 5)] -->
<g id="edge5" class="edge">
<title>FILTER BY (col("float")) &gt; (2f64) [(0, 4)]--TABLE
π */4;
σ -; [(0, 5)]</title>
<path fill="none" stroke="black" d="M125,-88.97C125,-78.51 125,-64.9 125,-53.16"></path>
</g>
</g>
</svg>
</div>
</div>
<div class="cell" data-execution_count="296">
<div class="sourceCode cell-code" id="cb376"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a>q.show_graph(optimized<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="polars_to_preview_files/figure-html/cell-297-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>Things to note:</p>
<ul>
<li>You will need Graphviz installed to visualize the query plan.</li>
<li>To understand the plan, you need some terminology from <a href="https://www.ibm.com/docs/en/informix-servers/14.10?topic=concepts-selection-projection">relational databases</a>. Namely:
<ul>
<li>A <em>selection</em> is a subset of rows, marked in the graph with a <span class="math display">\[\sigma\]</span>.</li>
<li>A <em>projection</em> is a subset of columns, marked in the graph with a <span class="math display">\[\pi\]</span>.</li>
</ul></li>
<li>The optimized plan removes redudancies, and orders the operations in the most efficient way.</li>
</ul>
<p>You can now execute the plan with a <code>collect()</code>:</p>
<div class="cell" data-execution_count="297">
<div class="sourceCode cell-code" id="cb377"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a>q.collect()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="292">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2, 1)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="298">
<div class="sourceCode cell-code" id="cb378"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a>q.describe_plan()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="293">
<pre><code>'  SORT BY [col("integer")]\n     SELECT [col("integer")] FROM\n      FILTER [(col("float")) &gt; (7f64)] FROM\n        FILTER [(col("float")) &gt; (3f64)] FROM\n          FILTER [(col("float")) &gt; (2f64)] FROM\n            DF ["integer", "date", "float", "string"]; PROJECT */4 COLUMNS; SELECTION: "None"\n'</code></pre>
</div>
</div>
<p>For early stopping you can replace <code>collect()</code> with <code>fetch()</code>:</p>
<div class="cell" data-execution_count="299">
<div class="sourceCode cell-code" id="cb380"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a>q.fetch(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="294">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2, 1)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="io" class="level1">
<h1>I/O</h1>
<p>You will find that polars is blazing fast at reading and writing data. This is due to:</p>
<ol type="1">
<li>Very good heuristics/rules implemented in the <code>read_csv</code> function.</li>
<li>The use of <a href="https://arrow.apache.org/">Apache Arrow</a> as an internal data structure, which maps seamlesly to the parquet file format.</li>
<li>Parallelism, whenever possible.</li>
<li>Lazy scans/imports, which allows the materialization only of required data; i.e., filters and projections are executed at scan time.</li>
</ol>
<section id="import" class="level2">
<h2 class="anchored" data-anchor-id="import">Import</h2>
<section id="from-a-single-file" class="level3">
<h3 class="anchored" data-anchor-id="from-a-single-file">From a Single File</h3>
<p>Let’s firs make a csv to import:</p>
<div class="cell" data-execution_count="300">
<div class="sourceCode cell-code" id="cb381"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a>df.write_csv(<span class="st">"df.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Import the csv into a non-lazy frame:</p>
<div class="cell" data-execution_count="301">
<div class="sourceCode cell-code" id="cb382"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a>pl.read_csv(<span class="st">"df.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="296">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (6, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
str
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
"2022-01-01T00:...
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
"2022-01-02T00:...
</td>
<td>
5.0
</td>
<td>
"b"
</td>
</tr>
<tr>
<td>
3
</td>
<td>
"2022-01-03T00:...
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
<tr>
<td>
1
</td>
<td>
"2022-01-04T00:...
</td>
<td>
7.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
"2022-01-05T00:...
</td>
<td>
8.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
3
</td>
<td>
"2022-01-06T00:...
</td>
<td>
9.0
</td>
<td>
"d"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Importing as a lazy frame:</p>
<div class="cell" data-execution_count="302">
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a>df_lazy <span class="op">=</span> pl.scan_csv(<span class="st">"df.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Things become interesting when you manipulate the lazy frame before materializing it:</p>
<div class="cell" data-execution_count="303">
<div class="sourceCode cell-code" id="cb384"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> (</span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a>  df_lazy</span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true" tabindex="-1"></a>  .<span class="bu">filter</span>(pl.col(<span class="st">"float"</span>) <span class="op">&gt;</span> <span class="fl">2.0</span>)</span>
<span id="cb384-4"><a href="#cb384-4" aria-hidden="true" tabindex="-1"></a>  .<span class="bu">filter</span>(pl.col(<span class="st">"float"</span>) <span class="op">&gt;</span> <span class="fl">3.0</span>)</span>
<span id="cb384-5"><a href="#cb384-5" aria-hidden="true" tabindex="-1"></a>  .<span class="bu">filter</span>(pl.col(<span class="st">"float"</span>) <span class="op">&gt;</span> <span class="fl">7.0</span>)</span>
<span id="cb384-6"><a href="#cb384-6" aria-hidden="true" tabindex="-1"></a>  .select([<span class="st">"integer"</span>])</span>
<span id="cb384-7"><a href="#cb384-7" aria-hidden="true" tabindex="-1"></a>  .sort(<span class="st">"integer"</span>)</span>
<span id="cb384-8"><a href="#cb384-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb384-9"><a href="#cb384-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-10"><a href="#cb384-10" aria-hidden="true" tabindex="-1"></a>q.show_graph(optimized<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="polars_to_preview_files/figure-html/cell-304-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="304">
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a>q.collect()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="299">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2, 1)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
integer
</th>
</tr>
<tr>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Things to note:</p>
<ul>
<li>From the graph we see that the filtering (<span class="math display">\[\sigma\]</span>) is done at scan time, and not after the materialization of the data.</li>
<li>To get the actual data, we naturally need to <code>collect()</code>.</li>
</ul>
<p>Cleary, .csv is not the only format that can be read. It is possibly the least recommended. Other file types can be found <a href="https://pola-rs.github.io/polars/py-polars/html/reference/io.html">here</a> and include: - Excel. - Arrow IPC: A binary format for storing columnar data. - Feather (V2): A portable columnar file format that is optimized for storing data in a fast and efficient manner, utilizing the Arrow IPC format internally. - Parquet (non-partitioned): A tabular file format (not columnar) that is optimized for long-term storage, more compressed than Feather. - JSON: Short for JavaScript Object Notation, a textual data-interchange format. - Avro: A binary row-based format.</p>
<p>Each of the above formats has a non-lazy reader using <code>pl.read_*</code> and a lazy reader using <code>pl.scan_*</code>.</p>
<p>Not suported formats: - Feather (V1). - HDF5: Currently <a href="https://github.com/pola-rs/polars/issues/3520">not supported</a>.</p>
</section>
<section id="from-multiple-files" class="level3">
<h3 class="anchored" data-anchor-id="from-multiple-files">From Multiple Files</h3>
<ul>
<li>Parquet (partitioned): A collection of files with a common schema, partitioned as folders on disk.</li>
<li>Delta Lake: Extends the Parquet file format.</li>
<li>Arrow Dataset: A collection of files (csv, parquet, feather, etc) with a common schema.</li>
</ul>
<section id="partitioned-parquet" class="level4">
<h4 class="anchored" data-anchor-id="partitioned-parquet">Partitioned Parquet</h4>
</section>
<section id="apache-arrow-dataset" class="level4">
<h4 class="anchored" data-anchor-id="apache-arrow-dataset">Apache Arrow Dataset</h4>
<p>An Apache Arrow dataset is a collection of parquet files, with a common schema. It is a very efficient way to store data on disk, and to read it in parallel.</p>
<p>Writing an Arrow dataset:</p>
<div class="cell" data-execution_count="305">
<div class="sourceCode cell-code" id="cb386"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a>df.to_pandas().to_parquet(<span class="st">"df"</span>, engine<span class="op">=</span><span class="st">"pyarrow"</span>, partition_cols<span class="op">=</span>[<span class="st">"integer"</span>])</span>
<span id="cb386-2"><a href="#cb386-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-3"><a href="#cb386-3" aria-hidden="true" tabindex="-1"></a>os.listdir(<span class="st">"df"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="300">
<pre><code>['integer=3', 'integer=1', 'integer=2']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="306">
<div class="sourceCode cell-code" id="cb388"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a>[os.listdir(<span class="ss">f"df/</span><span class="sc">{</span>x<span class="sc">}</span><span class="ss">/"</span>) <span class="cf">for</span> x <span class="kw">in</span> os.listdir(<span class="st">"df"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="301">
<pre><code>[['cb0f8bebc3ae4871babdb71a9f01d5f4-0.parquet',
  '9f0fe6efe3b94b9e8dd7d0c6ac7a2a53-0.parquet',
  '41306cbdcc7342f6bac989563486e60c-0.parquet',
  '14f5207aa9304833bda9e495021dbb90-0.parquet',
  'dd1d501d1c594e1684a863ddf32556ef-0.parquet',
  'ef77a8a9076d44e2904353dc092cb344-0.parquet',
  'a61f9978ecde4e0d81008ffdb4c5f9cd-0.parquet',
  '604952d90eff4208b0278cef8597226a-0.parquet',
  '5bb4705cbb1b4f8c8800a3c587836b91-0.parquet',
  '9299f8f27d51472dbfd8b51cb038d61d-0.parquet'],
 ['cb0f8bebc3ae4871babdb71a9f01d5f4-0.parquet',
  '9f0fe6efe3b94b9e8dd7d0c6ac7a2a53-0.parquet',
  '41306cbdcc7342f6bac989563486e60c-0.parquet',
  '14f5207aa9304833bda9e495021dbb90-0.parquet',
  'dd1d501d1c594e1684a863ddf32556ef-0.parquet',
  'ef77a8a9076d44e2904353dc092cb344-0.parquet',
  'a61f9978ecde4e0d81008ffdb4c5f9cd-0.parquet',
  '604952d90eff4208b0278cef8597226a-0.parquet',
  '5bb4705cbb1b4f8c8800a3c587836b91-0.parquet',
  '9299f8f27d51472dbfd8b51cb038d61d-0.parquet'],
 ['cb0f8bebc3ae4871babdb71a9f01d5f4-0.parquet',
  '9f0fe6efe3b94b9e8dd7d0c6ac7a2a53-0.parquet',
  '41306cbdcc7342f6bac989563486e60c-0.parquet',
  '14f5207aa9304833bda9e495021dbb90-0.parquet',
  'dd1d501d1c594e1684a863ddf32556ef-0.parquet',
  'ef77a8a9076d44e2904353dc092cb344-0.parquet',
  'a61f9978ecde4e0d81008ffdb4c5f9cd-0.parquet',
  '604952d90eff4208b0278cef8597226a-0.parquet',
  '5bb4705cbb1b4f8c8800a3c587836b91-0.parquet',
  '9299f8f27d51472dbfd8b51cb038d61d-0.parquet']]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="307">
<div class="sourceCode cell-code" id="cb390"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyarrow.dataset <span class="im">as</span> ds</span>
<span id="cb390-2"><a href="#cb390-2" aria-hidden="true" tabindex="-1"></a>dset <span class="op">=</span> ds.dataset(<span class="st">"df"</span>, <span class="bu">format</span><span class="op">=</span><span class="st">"parquet"</span>)  </span>
<span id="cb390-3"><a href="#cb390-3" aria-hidden="true" tabindex="-1"></a>pl.scan_ds(dset).collect()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="302">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (63, 3)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
2022-01-04 00:00:00
</td>
<td>
7.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
2022-01-04 00:00:00
</td>
<td>
7.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
2022-01-04 00:00:00
</td>
<td>
7.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
2022-01-04 00:00:00
</td>
<td>
7.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
2022-01-04 00:00:00
</td>
<td>
7.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
2022-01-04 00:00:00
</td>
<td>
7.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
</tr>
<tr>
<td>
2022-01-06 00:00:00
</td>
<td>
9.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
2022-01-06 00:00:00
</td>
<td>
9.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
<tr>
<td>
2022-01-06 00:00:00
</td>
<td>
9.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
<tr>
<td>
2022-01-06 00:00:00
</td>
<td>
9.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
<tr>
<td>
2022-01-06 00:00:00
</td>
<td>
9.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
<tr>
<td>
2022-01-06 00:00:00
</td>
<td>
9.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
2022-01-03 00:00:00
</td>
<td>
6.0
</td>
<td>
"c"
</td>
</tr>
<tr>
<td>
2022-01-06 00:00:00
</td>
<td>
9.0
</td>
<td>
"d"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Things to note:</p>
<ul>
<li>We used pandas to write the arrow dataset.</li>
<li>The <code>partition_cols</code> argument is used to partition the dataset on disk. Each partition is a parquet file (or another partition).</li>
<li>Reading from the web (not from the local filesystem) is slightly different. TODO: add reference.</li>
</ul>
<p><strong>Caution</strong>:</p>
<p>The arrow data format uses caching for string and categorical data (i.e.&nbsp;pl.Series). If importing multiple files, such as multiple parquet/feather files, or an arrow dataset, different files may be cached differnetly. This will cause an error when trying to concatenate the dataframes. To avoid this, you can disable string caching, or enforce <a href="https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.StringCache.html">joint caching</a> of all files. The latter will look like this:</p>
<div class="cell" data-execution_count="308">
<div class="sourceCode cell-code" id="cb391"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> pl.StringCache():</span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true" tabindex="-1"></a>  df_import <span class="op">=</span> pl.scan_ds(dset).collect()</span>
<span id="cb391-3"><a href="#cb391-3" aria-hidden="true" tabindex="-1"></a>df_import.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="303">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (3, 3)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
date
</th>
<th>
float
</th>
<th>
string
</th>
</tr>
<tr>
<td>
datetime[μs]
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
<tr>
<td>
2022-01-04 00:00:00
</td>
<td>
7.0
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
2022-01-01 00:00:00
</td>
<td>
4.0
</td>
<td>
"a"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="multiple-csvs" class="level4">
<h4 class="anchored" data-anchor-id="multiple-csvs">Multiple CSVs</h4>
<p>TODO: <code>pl.read_csv_batched()</code></p>
</section>
</section>
<section id="reading-from-a-database" class="level3">
<h3 class="anchored" data-anchor-id="reading-from-a-database">Reading from a Database</h3>
<p>TODO: SQL, Delta Lake.</p>
</section>
</section>
<section id="export-1" class="level2">
<h2 class="anchored" data-anchor-id="export-1">Export</h2>
<p>TODO</p>
</section>
</section>
<section id="plotting" class="level1">
<h1>Plotting</h1>
<p>To get an intuition of what you may expect in this chapter you should know the following. There are approaches to plotting in python:</p>
<ol type="1">
<li>The object oriented, where a dataframe has a plotting method. The method may use a single, or even multiple backends. Such is the pandas dataframe, which may use a matplotlib, plotly, or bokeh backend.</li>
<li>The functional method, where a plotting function takes a dataframe as an argument. Such are the matplotlib, seaborn, and plotly functions, which may take pandas dataframes as inputs.</li>
</ol>
<p>Plotting support in polars thus boils down to the folowing questions: (1) Do polars dataframes have a plotting method? With which backend? (2) Can plotting functions take polars dataframes as inputs?</p>
<p>The answer to the first is negative. Polars dataframes do not have a plotting method, and it seems they are not planned to have one (TODO: add reference). The answer to the second is “almost yes” Any plotting function that can take numpy 1D arrays as inputs, can take a polars series after a zero copy conversion with <code>pl.Series.to_numpy()</code>. Some plotting functions will not even require the conversion to numpy (and will handle it internally).</p>
<p>Polars frames may cause trouble. You may expect to use a <code>plot(df, x='col1', y='col2')</code> syntax; it may work if <code>df</code> is a pandas dataframe, but not with polars. Support of this syntax does not depend on polars developers, rather, on the plotting function developpers. I suspect that the plotly and bokeh teams will eventually supprts polars. I do not know about the seaborm, or matplotlib teams.</p>
<section id="plotly-functions" class="level2">
<h2 class="anchored" data-anchor-id="plotly-functions">Plotly Functions</h2>
<p>The <code>iris</code> dataset is provided by plotly as a pandas frame. We convert it to a polars frame.</p>
<div class="cell" data-execution_count="309">
<div class="sourceCode cell-code" id="cb392"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> pl.DataFrame(px.data.iris())</span>
<span id="cb392-2"><a href="#cb392-2" aria-hidden="true" tabindex="-1"></a>iris.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="304">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (5, 6)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
sepal_length
</th>
<th>
sepal_width
</th>
<th>
petal_length
</th>
<th>
petal_width
</th>
<th>
species
</th>
<th>
species_id
</th>
</tr>
<tr>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
str
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
5.1
</td>
<td>
3.5
</td>
<td>
1.4
</td>
<td>
0.2
</td>
<td>
"setosa"
</td>
<td>
1
</td>
</tr>
<tr>
<td>
4.9
</td>
<td>
3.0
</td>
<td>
1.4
</td>
<td>
0.2
</td>
<td>
"setosa"
</td>
<td>
1
</td>
</tr>
<tr>
<td>
4.7
</td>
<td>
3.2
</td>
<td>
1.3
</td>
<td>
0.2
</td>
<td>
"setosa"
</td>
<td>
1
</td>
</tr>
<tr>
<td>
4.6
</td>
<td>
3.1
</td>
<td>
1.5
</td>
<td>
0.2
</td>
<td>
"setosa"
</td>
<td>
1
</td>
</tr>
<tr>
<td>
5.0
</td>
<td>
3.6
</td>
<td>
1.4
</td>
<td>
0.2
</td>
<td>
"setosa"
</td>
<td>
1
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Plotly’s <code>scatter()</code> can take x and y as str, int or Series or array-like. The following will naturally work:</p>
<div class="cell" data-execution_count="310">
<div class="sourceCode cell-code" id="cb393"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter(</span>
<span id="cb393-2"><a href="#cb393-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>iris[<span class="st">"sepal_width"</span>].to_list(), </span>
<span id="cb393-3"><a href="#cb393-3" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>iris[<span class="st">"sepal_length"</span>].to_list())</span>
<span id="cb393-4"><a href="#cb393-4" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="2a426c48-cf08-4191-b189-36918c91b2de" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("2a426c48-cf08-4191-b189-36918c91b2de")) {                    Plotly.newPlot(                        "2a426c48-cf08-4191-b189-36918c91b2de",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[3.5,3.0,3.2,3.1,3.6,3.9,3.4,3.4,2.9,3.1,3.7,3.4,3.0,3.0,4.0,4.4,3.9,3.5,3.8,3.8,3.4,3.7,3.6,3.3,3.4,3.0,3.4,3.5,3.4,3.2,3.1,3.4,4.1,4.2,3.1,3.2,3.5,3.1,3.0,3.4,3.5,2.3,3.2,3.5,3.8,3.0,3.8,3.2,3.7,3.3,3.2,3.2,3.1,2.3,2.8,2.8,3.3,2.4,2.9,2.7,2.0,3.0,2.2,2.9,2.9,3.1,3.0,2.7,2.2,2.5,3.2,2.8,2.5,2.8,2.9,3.0,2.8,3.0,2.9,2.6,2.4,2.4,2.7,2.7,3.0,3.4,3.1,2.3,3.0,2.5,2.6,3.0,2.6,2.3,2.7,3.0,2.9,2.9,2.5,2.8,3.3,2.7,3.0,2.9,3.0,3.0,2.5,2.9,2.5,3.6,3.2,2.7,3.0,2.5,2.8,3.2,3.0,3.8,2.6,2.2,3.2,2.8,2.8,2.7,3.3,3.2,2.8,3.0,2.8,3.0,2.8,3.8,2.8,2.8,2.6,3.0,3.4,3.1,3.0,3.1,3.1,3.1,2.7,3.2,3.3,3.0,2.5,3.0,3.4,3.0],"xaxis":"x","y":[5.1,4.9,4.7,4.6,5.0,5.4,4.6,5.0,4.4,4.9,5.4,4.8,4.8,4.3,5.8,5.7,5.4,5.1,5.7,5.1,5.4,5.1,4.6,5.1,4.8,5.0,5.0,5.2,5.2,4.7,4.8,5.4,5.2,5.5,4.9,5.0,5.5,4.9,4.4,5.1,5.0,4.5,4.4,5.0,5.1,4.8,5.1,4.6,5.3,5.0,7.0,6.4,6.9,5.5,6.5,5.7,6.3,4.9,6.6,5.2,5.0,5.9,6.0,6.1,5.6,6.7,5.6,5.8,6.2,5.6,5.9,6.1,6.3,6.1,6.4,6.6,6.8,6.7,6.0,5.7,5.5,5.5,5.8,6.0,5.4,6.0,6.7,6.3,5.6,5.5,5.5,6.1,5.8,5.0,5.6,5.7,5.7,6.2,5.1,5.7,6.3,5.8,7.1,6.3,6.5,7.6,4.9,7.3,6.7,7.2,6.5,6.4,6.8,5.7,5.8,6.4,6.5,7.7,7.7,6.0,6.9,5.6,7.7,6.3,6.7,7.2,6.2,6.1,6.4,7.2,7.4,7.9,6.4,6.3,6.1,7.7,6.3,6.4,6.0,6.9,6.7,6.9,5.8,6.8,6.7,6.7,6.3,6.5,6.2,5.9],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"x"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y"}},"legend":{"tracegroupgap":0},"margin":{"t":60}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('2a426c48-cf08-4191-b189-36918c91b2de');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>But wait! Maybe a polars series is “array-like” and can be used as input? Yes it can!</p>
<div class="cell" data-execution_count="311">
<div class="sourceCode cell-code" id="cb394"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter(</span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>iris[<span class="st">"sepal_width"</span>], </span>
<span id="cb394-3"><a href="#cb394-3" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>iris[<span class="st">"sepal_length"</span>])</span>
<span id="cb394-4"><a href="#cb394-4" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="d0d832a4-3951-4313-b3af-93365714bdbe" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("d0d832a4-3951-4313-b3af-93365714bdbe")) {                    Plotly.newPlot(                        "d0d832a4-3951-4313-b3af-93365714bdbe",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[3.5,3.0,3.2,3.1,3.6,3.9,3.4,3.4,2.9,3.1,3.7,3.4,3.0,3.0,4.0,4.4,3.9,3.5,3.8,3.8,3.4,3.7,3.6,3.3,3.4,3.0,3.4,3.5,3.4,3.2,3.1,3.4,4.1,4.2,3.1,3.2,3.5,3.1,3.0,3.4,3.5,2.3,3.2,3.5,3.8,3.0,3.8,3.2,3.7,3.3,3.2,3.2,3.1,2.3,2.8,2.8,3.3,2.4,2.9,2.7,2.0,3.0,2.2,2.9,2.9,3.1,3.0,2.7,2.2,2.5,3.2,2.8,2.5,2.8,2.9,3.0,2.8,3.0,2.9,2.6,2.4,2.4,2.7,2.7,3.0,3.4,3.1,2.3,3.0,2.5,2.6,3.0,2.6,2.3,2.7,3.0,2.9,2.9,2.5,2.8,3.3,2.7,3.0,2.9,3.0,3.0,2.5,2.9,2.5,3.6,3.2,2.7,3.0,2.5,2.8,3.2,3.0,3.8,2.6,2.2,3.2,2.8,2.8,2.7,3.3,3.2,2.8,3.0,2.8,3.0,2.8,3.8,2.8,2.8,2.6,3.0,3.4,3.1,3.0,3.1,3.1,3.1,2.7,3.2,3.3,3.0,2.5,3.0,3.4,3.0],"xaxis":"x","y":[5.1,4.9,4.7,4.6,5.0,5.4,4.6,5.0,4.4,4.9,5.4,4.8,4.8,4.3,5.8,5.7,5.4,5.1,5.7,5.1,5.4,5.1,4.6,5.1,4.8,5.0,5.0,5.2,5.2,4.7,4.8,5.4,5.2,5.5,4.9,5.0,5.5,4.9,4.4,5.1,5.0,4.5,4.4,5.0,5.1,4.8,5.1,4.6,5.3,5.0,7.0,6.4,6.9,5.5,6.5,5.7,6.3,4.9,6.6,5.2,5.0,5.9,6.0,6.1,5.6,6.7,5.6,5.8,6.2,5.6,5.9,6.1,6.3,6.1,6.4,6.6,6.8,6.7,6.0,5.7,5.5,5.5,5.8,6.0,5.4,6.0,6.7,6.3,5.6,5.5,5.5,6.1,5.8,5.0,5.6,5.7,5.7,6.2,5.1,5.7,6.3,5.8,7.1,6.3,6.5,7.6,4.9,7.3,6.7,7.2,6.5,6.4,6.8,5.7,5.8,6.4,6.5,7.7,7.7,6.0,6.9,5.6,7.7,6.3,6.7,7.2,6.2,6.1,6.4,7.2,7.4,7.9,6.4,6.3,6.1,7.7,6.3,6.4,6.0,6.9,6.7,6.9,5.8,6.8,6.7,6.7,6.3,6.5,6.2,5.9],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"x"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y"}},"legend":{"tracegroupgap":0},"margin":{"t":60}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('d0d832a4-3951-4313-b3af-93365714bdbe');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>Can a polars frame be used as input? No it can not. The following will not work:</p>
<div class="cell" data-execution_count="312">
<div class="sourceCode cell-code" id="cb395"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter(data_frame<span class="op">=</span>iris,</span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"sepal_width"</span>,</span>
<span id="cb395-3"><a href="#cb395-3" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"sepal_length"</span>)</span>
<span id="cb395-4"><a href="#cb395-4" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="matplotlib-functions" class="level2">
<h2 class="anchored" data-anchor-id="matplotlib-functions">Matplotlib Functions</h2>
<p>The above discussion applies to matplotlib functions as well; with the exception that matplotlib functions already support polars frames as input.</p>
<p>Inputing polars series:</p>
<div class="cell" data-execution_count="313">
<div class="sourceCode cell-code" id="cb396"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true" tabindex="-1"></a>ax.scatter(</span>
<span id="cb396-3"><a href="#cb396-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>iris[<span class="st">"sepal_width"</span>], </span>
<span id="cb396-4"><a href="#cb396-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>iris[<span class="st">"sepal_length"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="307">
<pre><code>&lt;matplotlib.collections.PathCollection at 0x7fb672e78490&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="polars_to_preview_files/figure-html/cell-314-output-2.png" width="577" height="411"></p>
</div>
</div>
<p>Inputing polars frames:</p>
<div class="cell" data-execution_count="314">
<div class="sourceCode cell-code" id="cb398"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb398-2"><a href="#cb398-2" aria-hidden="true" tabindex="-1"></a>ax.scatter(</span>
<span id="cb398-3"><a href="#cb398-3" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>iris,</span>
<span id="cb398-4"><a href="#cb398-4" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"sepal_width"</span>,</span>
<span id="cb398-5"><a href="#cb398-5" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"sepal_length"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="308">
<pre><code>&lt;matplotlib.collections.PathCollection at 0x7fb67bf08190&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="polars_to_preview_files/figure-html/cell-315-output-2.png" width="577" height="411"></p>
</div>
</div>
</section>
</section>
<section id="polars-and-ml" class="level1">
<h1>Polars and ML</h1>
<p>“How do to machine learning with polars?” is not a well defined question. ML can be done with many libraries, and the answer depends on the library you are using. One possibility is converting polars dataframes to a numpy arrays. This is very easy with <code>pl.Float64</code> and <code>pl.Int64</code> series which convert trivially. Converting <code>pl.Utf8</code> and <code>pl.Categorical</code> dtypes is a bit more involved, but still possible. For instance, by using <code>polars.DataFrame.to_dummies()</code>, <code>polars.get_dummies()</code>, or <code>polars.Series.to_dummies()</code>.</p>
<section id="polars-and-patsy" class="level2">
<h2 class="anchored" data-anchor-id="polars-and-patsy">Polars and Patsy</h2>
<p>Patsy is a python library for describing statistical models (especially linear models and generalized linear models) and building design matrices.</p>
<div class="cell" data-execution_count="315">
<div class="sourceCode cell-code" id="cb400"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> patsy <span class="im">as</span> pt</span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-3"><a href="#cb400-3" aria-hidden="true" tabindex="-1"></a><span class="co">#make a dataframe</span></span>
<span id="cb400-4"><a href="#cb400-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame(</span>
<span id="cb400-5"><a href="#cb400-5" aria-hidden="true" tabindex="-1"></a>    np.random.randn(<span class="dv">100</span>, <span class="dv">3</span>), </span>
<span id="cb400-6"><a href="#cb400-6" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>[<span class="st">"y"</span>, <span class="st">"x1"</span>, <span class="st">"x2"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Use patsy to make a design matrix <span class="math display">\[X\]</span>, and a target vector <span class="math display">\[y\]</span> from a pandas dataframe.</p>
<div class="cell" data-execution_count="316">
<div class="sourceCode cell-code" id="cb401"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a>formula <span class="op">=</span> <span class="st">'y ~ x1 + x2'</span></span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true" tabindex="-1"></a>y, X <span class="op">=</span> pt.dmatrices(formula, data)</span>
<span id="cb401-3"><a href="#cb401-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-4"><a href="#cb401-4" aria-hidden="true" tabindex="-1"></a>X[:<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="310">
<pre><code>array([[ 1.        ,  0.99734545,  0.2829785 ],
       [ 1.        , -0.57860025,  1.65143654],
       [ 1.        , -0.42891263,  1.26593626]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="317">
<div class="sourceCode cell-code" id="cb403"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a>y[:<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="311">
<pre><code>array([[-1.0856306 ],
       [-1.50629471],
       [-2.42667924]])</code></pre>
</div>
</div>
<p>Does the same work with polars? Yes!</p>
<div class="cell" data-execution_count="318">
<div class="sourceCode cell-code" id="cb405"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a>data_polars<span class="op">=</span> pl.DataFrame(data)</span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true" tabindex="-1"></a>X, y <span class="op">=</span> pt.dmatrices(formula, data_polars)</span>
<span id="cb405-3"><a href="#cb405-3" aria-hidden="true" tabindex="-1"></a>X[:<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="312">
<pre><code>array([[-1.0856306 ],
       [-1.50629471],
       [-2.42667924]])</code></pre>
</div>
</div>
</section>
<section id="effect-coding-and-contrasts" class="level2">
<h2 class="anchored" data-anchor-id="effect-coding-and-contrasts">Effect Coding and Contrasts</h2>
<p>There are <a href="https://stats.oarc.ucla.edu/spss/faq/coding-systems-for-categorical-variables-in-regression-analysis/">many ways</a> to encode categorical variables. For predictions, dummy coding is enough. If you want to discuss and infer on effect sizes, you may want to use other coding schemes.</p>
<p>One way to go about is to use the <a href="http://contrib.scikit-learn.org/category_encoders/">category_encoders</a> library.</p>
<p>We start by making some categorical data.</p>
<div class="cell" data-execution_count="319">
<div class="sourceCode cell-code" id="cb407"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> string</span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb407-3"><a href="#cb407-3" aria-hidden="true" tabindex="-1"></a>cat <span class="op">=</span> pl.Series(</span>
<span id="cb407-4"><a href="#cb407-4" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"cat"</span>,</span>
<span id="cb407-5"><a href="#cb407-5" aria-hidden="true" tabindex="-1"></a>    values<span class="op">=</span>random.choices(</span>
<span id="cb407-6"><a href="#cb407-6" aria-hidden="true" tabindex="-1"></a>        population<span class="op">=</span>string.ascii_letters[:<span class="dv">5</span>], </span>
<span id="cb407-7"><a href="#cb407-7" aria-hidden="true" tabindex="-1"></a>        k<span class="op">=</span>data_polars.height)</span>
<span id="cb407-8"><a href="#cb407-8" aria-hidden="true" tabindex="-1"></a>    ).to_frame()</span>
<span id="cb407-9"><a href="#cb407-9" aria-hidden="true" tabindex="-1"></a>data_polars <span class="op">=</span> data_polars.hstack(cat)</span>
<span id="cb407-10"><a href="#cb407-10" aria-hidden="true" tabindex="-1"></a>data_polars.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="313">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (5, 4)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
y
</th>
<th>
x1
</th>
<th>
x2
</th>
<th>
cat
</th>
</tr>
<tr>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
-1.085631
</td>
<td>
0.997345
</td>
<td>
0.282978
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
-1.506295
</td>
<td>
-0.5786
</td>
<td>
1.651437
</td>
<td>
"d"
</td>
</tr>
<tr>
<td>
-2.426679
</td>
<td>
-0.428913
</td>
<td>
1.265936
</td>
<td>
"e"
</td>
</tr>
<tr>
<td>
-0.86674
</td>
<td>
-0.678886
</td>
<td>
-0.094709
</td>
<td>
"c"
</td>
</tr>
<tr>
<td>
1.49139
</td>
<td>
-0.638902
</td>
<td>
-0.443982
</td>
<td>
"c"
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The category encoders currently expects pandas dataframes as input, and does not support polars dataframes.</p>
<div class="cell" data-execution_count="320">
<div class="sourceCode cell-code" id="cb408"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> category_encoders <span class="im">as</span> ce</span>
<span id="cb408-2"><a href="#cb408-2" aria-hidden="true" tabindex="-1"></a>encoder <span class="op">=</span> ce.HelmertEncoder()</span>
<span id="cb408-3"><a href="#cb408-3" aria-hidden="true" tabindex="-1"></a>encoder.fit(data_polars.to_pandas())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/johnros/workspace/practicing_python_2/venv/lib/python3.10/site-packages/category_encoders/base_contrast_encoder.py:126: FutureWarning:

Intercept column might not be added anymore in future releases (c.f. issue #370)
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="314">
<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>HelmertEncoder(cols=['cat'],
               mapping=[{'col': 'cat',
                         'mapping':     cat_0  cat_1  cat_2  cat_3
 1   -1.0   -1.0   -1.0   -1.0
 2    1.0   -1.0   -1.0   -1.0
 3    0.0    2.0   -1.0   -1.0
 4    0.0    0.0    3.0   -1.0
 5    0.0    0.0    0.0    4.0
-1    0.0    0.0    0.0    0.0
-2    0.0    0.0    0.0    0.0}])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">HelmertEncoder</label><div class="sk-toggleable__content"><pre>HelmertEncoder(cols=['cat'],
               mapping=[{'col': 'cat',
                         'mapping':     cat_0  cat_1  cat_2  cat_3
 1   -1.0   -1.0   -1.0   -1.0
 2    1.0   -1.0   -1.0   -1.0
 3    0.0    2.0   -1.0   -1.0
 4    0.0    0.0    3.0   -1.0
 5    0.0    0.0    0.0    4.0
-1    0.0    0.0    0.0    0.0
-2    0.0    0.0    0.0    0.0}])</pre></div></div></div></div></div>
</div>
</div>
</section>
</section>
<section id="strings-1" class="level1">
<h1>Strings</h1>
</section>
<section id="datatimes" class="level1">
<h1>Datatimes</h1>
</section>
<section id="config" class="level1">
<h1>Config</h1>
<div class="cell" data-execution_count="321">
<div class="sourceCode cell-code" id="cb410"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(<span class="bu">dir</span>(pl.Config))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="315">
<pre><code>['__annotations__',
 '__class__',
 '__delattr__',
 '__dict__',
 '__dir__',
 '__doc__',
 '__enter__',
 '__eq__',
 '__exit__',
 '__format__',
 '__ge__',
 '__getattribute__',
 '__gt__',
 '__hash__',
 '__init__',
 '__init_subclass__',
 '__le__',
 '__lt__',
 '__module__',
 '__ne__',
 '__new__',
 '__reduce__',
 '__reduce_ex__',
 '__repr__',
 '__setattr__',
 '__sizeof__',
 '__str__',
 '__subclasshook__',
 '__weakref__',
 'load',
 'restore_defaults',
 'save',
 'set_ascii_tables',
 'set_fmt_str_lengths',
 'set_tbl_cell_alignment',
 'set_tbl_cols',
 'set_tbl_column_data_type_inline',
 'set_tbl_dataframe_shape_below',
 'set_tbl_formatting',
 'set_tbl_hide_column_data_types',
 'set_tbl_hide_column_names',
 'set_tbl_hide_dataframe_shape',
 'set_tbl_hide_dtype_separator',
 'set_tbl_rows',
 'set_tbl_width_chars',
 'set_verbose',
 'state',
 'with_columns_kwargs']</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>